{"cells":[{"cell_type":"code","execution_count":1,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":51762,"status":"ok","timestamp":1604477542202,"user":{"displayName":"Ankit Mishra","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14Gj2-BPUB24Nb2m9nv0HdWn-cRfQoBp0ocGjhX-k=s64","userId":"11667803432738710858"},"user_tz":-330},"id":"bhywlNlbN_Jd","outputId":"a9de6405-a1aa-46a8-96be-5dd0527b5816"},"outputs":[{"name":"stdout","output_type":"stream","text":["Mounted at /content/drive\n"]}],"source":["from google.colab import drive\n","drive.mount('/content/drive')"]},{"cell_type":"markdown","metadata":{"id":"y_d9qt_enQhM"},"source":["#READING DATA"]},{"cell_type":"code","execution_count":2,"metadata":{"executionInfo":{"elapsed":51763,"status":"ok","timestamp":1604477542210,"user":{"displayName":"Ankit Mishra","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14Gj2-BPUB24Nb2m9nv0HdWn-cRfQoBp0ocGjhX-k=s64","userId":"11667803432738710858"},"user_tz":-330},"id":"XgN6BDPykeC0"},"outputs":[],"source":["import pandas as pd\n","pd.set_option('display.max_colwidth',100)"]},{"cell_type":"code","execution_count":3,"metadata":{"colab":{"base_uri":"https://localhost:8080/","height":363},"executionInfo":{"elapsed":55969,"status":"ok","timestamp":1604477546434,"user":{"displayName":"Ankit Mishra","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14Gj2-BPUB24Nb2m9nv0HdWn-cRfQoBp0ocGjhX-k=s64","userId":"11667803432738710858"},"user_tz":-330},"id":"wUF4eOgoliue","outputId":"25ba5479-437e-484d-ea4b-04866fe496c0"},"outputs":[{"data":{"text/html":["\u003cdiv\u003e\n","\u003cstyle scoped\u003e\n","    .dataframe tbody tr th:only-of-type {\n","        vertical-align: middle;\n","    }\n","\n","    .dataframe tbody tr th {\n","        vertical-align: top;\n","    }\n","\n","    .dataframe thead th {\n","        text-align: right;\n","    }\n","\u003c/style\u003e\n","\u003ctable border=\"1\" class=\"dataframe\"\u003e\n","  \u003cthead\u003e\n","    \u003ctr style=\"text-align: right;\"\u003e\n","      \u003cth\u003e\u003c/th\u003e\n","      \u003cth\u003eUnique ID\u003c/th\u003e\n","      \u003cth\u003ePost\u003c/th\u003e\n","      \u003cth\u003eLabels Set\u003c/th\u003e\n","    \u003c/tr\u003e\n","  \u003c/thead\u003e\n","  \u003ctbody\u003e\n","    \u003ctr\u003e\n","      \u003cth\u003e0\u003c/th\u003e\n","      \u003ctd\u003e1\u003c/td\u003e\n","      \u003ctd\u003e‡§Æ‡•á‡§∞‡•á ‡§¶‡•á‡§∂ ‡§ï‡•á ‡§π‡§ø‡§®‡•ç‡§¶‡•Å ‡§¨‡§π‡•Å‡§§ ‡§®‡§ø‡§∞‡§æ‡§≤‡•á ‡§π‡•à‡•§ ‡§ï‡•Å‡§õ ‡§§‡•ã ‡§™‡§ï‡•ç‡§ï‡•á ‡§∞‡§æ‡§Æ ‡§≠‡§ï‡•ç‡§§ ‡§π‡•à ‡§î‡§∞ ‡§ï‡•Å‡§õ ‡§¨‡§æ‡§¨‡§∞ ‡§ï‡•á ‡§∏‡§æ‡§≤‡•á ‡§π‡•à \\n\\nüôè ‡§ú‡§Ø ‡§∂‡•ç‡§∞‡•Ä...\u003c/td\u003e\n","      \u003ctd\u003ehate,offensive\u003c/td\u003e\n","    \u003c/tr\u003e\n","    \u003ctr\u003e\n","      \u003cth\u003e1\u003c/th\u003e\n","      \u003ctd\u003e2\u003c/td\u003e\n","      \u003ctd\u003e‡§∏‡§∞‡§ï‡§æ‡§∞ ‡§π‡§Æ‡•á‡§∂‡§æ ‡§∏‡•á ‡§ï‡§ø‡§∏‡§æ‡§®‡•ã‡§Ç ‡§ï‡•Ä ‡§ï‡§Æ‡§æ‡§à ‡§ï‡•ã ‡§¨‡§¢‡§º‡§æ‡§®‡•á ‡§ï‡•á ‡§≤‡§ø‡§è ‡§®‡§à-‡§®‡§à ‡§∏‡•ç‡§ï‡•Ä‡§Æ‡•á‡§Ç ‡§≤‡§æ‡§§‡•Ä ‡§∞‡§π‡§§‡•Ä ‡§π‡•à, ‡§§‡§æ‡§ï‡§ø ‡§â‡§® ‡§™‡§∞ ‡§ú‡•ç‡§Ø‡§æ‡§¶‡§æ ‡§Ü‡§∞...\u003c/td\u003e\n","      \u003ctd\u003enon-hostile\u003c/td\u003e\n","    \u003c/tr\u003e\n","    \u003ctr\u003e\n","      \u003cth\u003e2\u003c/th\u003e\n","      \u003ctd\u003e3\u003c/td\u003e\n","      \u003ctd\u003e‡§∏‡•Å‡§∂‡§æ‡§Ç‡§§ ‡§®‡•á ‡§ú‡•ã ‡§¨‡§ø‡§ú‡§®‡•á‡§∏ ‡§°‡•Ä‡§≤ 9 ‡§ú‡•Ç‡§® ‡§ï‡•ã ‡§ï‡•Ä ‡§•‡•Ä, ‡§µ‡•ã ‡§°‡•Ä‡§≤ ‡§¶‡•Ä‡§™‡•á‡§∂ ‡§ï‡•ã ‡§∏‡•Å‡§∂‡§æ‡§Ç‡§§ ‡§ï‡•Ä ‡§π‡§§‡•ç‡§Ø‡§æ ‡§ï‡•á ‡§¶‡§ø‡§® ‡§π‡•Ä ‡§ï‡•ç‡§Ø‡•ã‡§Ç ‡§Ø‡§æ‡§¶ ‡§Ü‡§à? ...\u003c/td\u003e\n","      \u003ctd\u003enon-hostile\u003c/td\u003e\n","    \u003c/tr\u003e\n","    \u003ctr\u003e\n","      \u003cth\u003e3\u003c/th\u003e\n","      \u003ctd\u003e4\u003c/td\u003e\n","      \u003ctd\u003e@prabhav218 ‡§∏‡§æ‡§≤‡•á ‡§ú‡•á‡§è‡§®‡§Ø‡•Ç ‡§õ‡§æ‡§™ ‡§ï‡§Æ‡§ø‡§®‡•á ‡§≤‡•ã‡§ó ‡§π‡§ø‡§®‡•ç‡§¶‡•Å‡§ì‡§Ç ‡§ï‡•ã ‡§Ø‡§π ‡§ï‡§π‡§§‡•á ‡§π‡•à ‡§ï‡•Ä ‡§∏‡§Ç‡§µ‡§ø‡§ß‡§æ‡§® ‡§∏‡§¨‡§ï‡•ã ‡§¨‡§∞‡§æ‡§¨‡§∞ ‡§Ö‡§ß‡§ø‡§ï‡§æ‡§∞ ‡§¶‡•á‡§§‡§æ ‡§π...\u003c/td\u003e\n","      \u003ctd\u003edefamation,offensive\u003c/td\u003e\n","    \u003c/tr\u003e\n","    \u003ctr\u003e\n","      \u003cth\u003e4\u003c/th\u003e\n","      \u003ctd\u003e5\u003c/td\u003e\n","      \u003ctd\u003e#unlock4guidelines - ‡§Ö‡§®‡§≤‡•â‡§ï-4 ‡§ï‡•á ‡§≤‡§ø‡§è ‡§ó‡§æ‡§á‡§°‡§≤‡§æ‡§á‡§®‡•ç‡§∏ ‡§ú‡§æ‡§∞‡•Ä\\n\\n- 7 ‡§∏‡§ø‡§§‡§Ç‡§¨‡§∞ ‡§∏‡•á ‡§¶‡•á‡§∂‡§≠‡§∞ ‡§Æ‡•á‡§Ç ‡§Æ‡•á‡§ü‡•ç‡§∞‡•ã ‡§∏‡•á‡§µ‡§æ ‡§∂‡•Å‡§∞‡•Å ...\u003c/td\u003e\n","      \u003ctd\u003enon-hostile\u003c/td\u003e\n","    \u003c/tr\u003e\n","    \u003ctr\u003e\n","      \u003cth\u003e5\u003c/th\u003e\n","      \u003ctd\u003e6\u003c/td\u003e\n","      \u003ctd\u003e‡§ö‡•Ä‡§® ‡§®‡•á UN ‡§Æ‡•á‡§Ç ‡§§‡§∞‡•ç‡§ï ‡§¶‡§ø‡§Ø‡§æ ‡§ï‡•Ä ‡§≠‡§æ‡§∞‡§§ ‡§ï‡§æ ‡§µ‡§ø‡§™‡§ï‡•ç‡§∑ ‡§π‡•Ä ‡§Ö‡§ú‡§∞‚Äå ‡§Æ‡§∏‡•Å‡§¶ ‡§ï‡•ã ‡§Ü‡§§‡§Ç‡§ï‡•Ä ‡§®‡§π‡•Ä‡§Ç ‡§Æ‡§æ‡§®‡§§‡§æ ‡§§‡•ã ‡§π‡§Æ ‡§ï‡•à‡§∏‡•á ‡§Æ‡§æ‡§®‡•á‡•§ ‡§ö‡•Å‡§≤‡•ç...\u003c/td\u003e\n","      \u003ctd\u003efake\u003c/td\u003e\n","    \u003c/tr\u003e\n","    \u003ctr\u003e\n","      \u003cth\u003e6\u003c/th\u003e\n","      \u003ctd\u003e7\u003c/td\u003e\n","      \u003ctd\u003e‡§¶‡•á‡§∂ ‡§Æ‡•á‡§Ç #Corona ‡§ï‡•á ‡§∞‡§ø‡§ï‡•â‡§∞‡•ç‡§° ‡§Æ‡§æ‡§Æ‡§≤‡•á  \\n#ZeeJankariOnCorona  \\n@Sheerin_sherry https://t.co/V6UddREAtW\u003c/td\u003e\n","      \u003ctd\u003enon-hostile\u003c/td\u003e\n","    \u003c/tr\u003e\n","    \u003ctr\u003e\n","      \u003cth\u003e7\u003c/th\u003e\n","      \u003ctd\u003e8\u003c/td\u003e\n","      \u003ctd\u003e#JEE Exam center ‡§∏‡•á ‡§®‡§ø‡§ï‡§≤‡•á #Students ‡§ï‡•ã ‡§∏‡•Å‡§® ‡§¨‡§æ‡§ï‡•Ä ‡§õ‡§æ‡§§‡•ç‡§∞‡•ã‡§Ç ‡§ï‡•á ‡§∏‡§æ‡§• Parents ‡§ï‡•á ‡§ö‡•á‡§π‡§∞‡•á ‡§™‡§∞ ‡§Æ‡•Å‡§∏‡•ç‡§ï‡§æ‡§® ‡§Ü ‡§ú‡§æ‡§è...\u003c/td\u003e\n","      \u003ctd\u003enon-hostile\u003c/td\u003e\n","    \u003c/tr\u003e\n","    \u003ctr\u003e\n","      \u003cth\u003e8\u003c/th\u003e\n","      \u003ctd\u003e9\u003c/td\u003e\n","      \u003ctd\u003e#AkshayKumar ‡§ú‡§≤‡•ç‡§¶ ‡§π‡•Ä ‡§¨‡•á‡§Ø‡§∞ ‡§ó‡•ç‡§∞‡§ø‡§≤‡•ç‡§∏ ‡§ï‡•á ‡§∂‡•ã '‡§á‡§Ç‡§ü‡•Ç ‡§¶ ‡§µ‡§æ‡§á‡§≤‡•ç‡§° ‡§µ‡§ø‡§¶ ‡§¨‡•á‡§Ø‡§∞ ‡§ó‡•ç‡§∞‡§ø‡§≤‡•ç‡§∏' ‡§Æ‡•á‡§Ç ‡§®‡§ú‡§∞ ‡§Ü‡§®‡•á ‡§µ‡§æ‡§≤‡•á ‡§π‡•à‡§Ç‡•§ \\...\u003c/td\u003e\n","      \u003ctd\u003enon-hostile\u003c/td\u003e\n","    \u003c/tr\u003e\n","    \u003ctr\u003e\n","      \u003cth\u003e9\u003c/th\u003e\n","      \u003ctd\u003e10\u003c/td\u003e\n","      \u003ctd\u003e#‡§ú‡•Ä‡§µ‡§®‡§∏‡§Ç‡§µ‡§æ‡§¶: ‡§π‡§Æ ‡§∏‡§Ç‡§ò‡§∞‡•ç‡§∑ ‡§ï‡§∞‡§®‡§æ ‡§ö‡§æ‡§π‡§§‡•á ‡§π‡•à‡§Ç, ‡§ï‡•ç‡§Ø‡•ã‡§Ç‡§ï‡§ø ‡§∏‡§æ‡§Æ‡§®‡•á ‡§∏‡§Ç‡§ò‡§∞‡•ç‡§∑ ‡§ï‡•Ä ‡§Æ‡§ø‡§∏‡§æ‡§≤ ‡§∞‡§ñ‡§®‡§æ ‡§ö‡§æ‡§π‡§§‡•á ‡§π‡•à‡§Ç. ‡§®‡§è ‡§∂‡§π‡§∞ ‡§Æ‡•á‡§Ç ‡§á...\u003c/td\u003e\n","      \u003ctd\u003enon-hostile\u003c/td\u003e\n","    \u003c/tr\u003e\n","  \u003c/tbody\u003e\n","\u003c/table\u003e\n","\u003c/div\u003e"],"text/plain":["   Unique ID  ...            Labels Set\n","0          1  ...        hate,offensive\n","1          2  ...           non-hostile\n","2          3  ...           non-hostile\n","3          4  ...  defamation,offensive\n","4          5  ...           non-hostile\n","5          6  ...                  fake\n","6          7  ...           non-hostile\n","7          8  ...           non-hostile\n","8          9  ...           non-hostile\n","9         10  ...           non-hostile\n","\n","[10 rows x 3 columns]"]},"execution_count":3,"metadata":{"tags":[]},"output_type":"execute_result"}],"source":["Data=pd.read_excel('drive/My Drive/Ankit/october2020 codalab/hindi/constraint_Hindi_Train.xlsx')\n","Data.dropna(inplace = True)\n","Data.head(10)"]},{"cell_type":"code","execution_count":4,"metadata":{"executionInfo":{"elapsed":55966,"status":"ok","timestamp":1604477546437,"user":{"displayName":"Ankit Mishra","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14Gj2-BPUB24Nb2m9nv0HdWn-cRfQoBp0ocGjhX-k=s64","userId":"11667803432738710858"},"user_tz":-330},"id":"VF3Z2qsWb-_h"},"outputs":[],"source":["DataLabel=Data['Labels Set']"]},{"cell_type":"code","execution_count":5,"metadata":{"executionInfo":{"elapsed":55968,"status":"ok","timestamp":1604477546444,"user":{"displayName":"Ankit Mishra","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14Gj2-BPUB24Nb2m9nv0HdWn-cRfQoBp0ocGjhX-k=s64","userId":"11667803432738710858"},"user_tz":-330},"id":"nbBNk19EXeTX"},"outputs":[],"source":["#import numpy as np\n","#from keras.utils import to_categorical\n","#labelList= [\"fake\",\"hate\", \"offensive\", \"defamation\", \"non-hostile\"]\n","#mapping = {}\n","#for x in range(len(total_colors)):\n","#  mapping[total_colors[x]] = x"]},{"cell_type":"markdown","metadata":{"id":"8I_LZ9dTnh8L"},"source":["#DATA preprocessing"]},{"cell_type":"code","execution_count":6,"metadata":{"executionInfo":{"elapsed":56781,"status":"ok","timestamp":1604477547261,"user":{"displayName":"Ankit Mishra","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14Gj2-BPUB24Nb2m9nv0HdWn-cRfQoBp0ocGjhX-k=s64","userId":"11667803432738710858"},"user_tz":-330},"id":"z_4mk2yFl1Qx"},"outputs":[],"source":["import nltk\n","import re"]},{"cell_type":"code","execution_count":7,"metadata":{"executionInfo":{"elapsed":56779,"status":"ok","timestamp":1604477547264,"user":{"displayName":"Ankit Mishra","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14Gj2-BPUB24Nb2m9nv0HdWn-cRfQoBp0ocGjhX-k=s64","userId":"11667803432738710858"},"user_tz":-330},"id":"iGaJE2lNnqOq"},"outputs":[],"source":["def deEmojify(txt):\n","    regrex_pattern = re.compile(\"[\"\n","        u\"\\U0001F600-\\U0001F64F\"  # emoticons\n","        u\"\\U0001F300-\\U0001F5FF\"  # symbols \u0026 pictographs\n","        u\"\\U0001F680-\\U0001F6FF\"  # transport \u0026 map symbols\n","        u\"\\U0001F1E0-\\U0001F1FF\"  # flags (iOS)\n","                           \"]+\", flags = re.UNICODE)\n","    return regrex_pattern.sub(r'',txt)\n","Data['Post']=Data['Post'].apply(lambda x:deEmojify(x))"]},{"cell_type":"code","execution_count":8,"metadata":{"executionInfo":{"elapsed":56777,"status":"ok","timestamp":1604477547266,"user":{"displayName":"Ankit Mishra","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14Gj2-BPUB24Nb2m9nv0HdWn-cRfQoBp0ocGjhX-k=s64","userId":"11667803432738710858"},"user_tz":-330},"id":"1GTohk87oBv_"},"outputs":[],"source":["def remove_URL(txt):\n","    url= re.compile(r\"https?://\\S+|www\\.\\S+\")\n","    return url.sub(r\"\",txt)\n","Data['Post']=Data['Post'].apply(lambda x:remove_URL(x))"]},{"cell_type":"code","execution_count":9,"metadata":{"colab":{"base_uri":"https://localhost:8080/","height":206},"executionInfo":{"elapsed":56770,"status":"ok","timestamp":1604477547270,"user":{"displayName":"Ankit Mishra","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14Gj2-BPUB24Nb2m9nv0HdWn-cRfQoBp0ocGjhX-k=s64","userId":"11667803432738710858"},"user_tz":-330},"id":"xt0QKt5_ofdR","outputId":"3245e1bb-64b1-4c41-8809-b480795b391b"},"outputs":[{"data":{"text/html":["\u003cdiv\u003e\n","\u003cstyle scoped\u003e\n","    .dataframe tbody tr th:only-of-type {\n","        vertical-align: middle;\n","    }\n","\n","    .dataframe tbody tr th {\n","        vertical-align: top;\n","    }\n","\n","    .dataframe thead th {\n","        text-align: right;\n","    }\n","\u003c/style\u003e\n","\u003ctable border=\"1\" class=\"dataframe\"\u003e\n","  \u003cthead\u003e\n","    \u003ctr style=\"text-align: right;\"\u003e\n","      \u003cth\u003e\u003c/th\u003e\n","      \u003cth\u003eUnique ID\u003c/th\u003e\n","      \u003cth\u003ePost\u003c/th\u003e\n","      \u003cth\u003eLabels Set\u003c/th\u003e\n","    \u003c/tr\u003e\n","  \u003c/thead\u003e\n","  \u003ctbody\u003e\n","    \u003ctr\u003e\n","      \u003cth\u003e0\u003c/th\u003e\n","      \u003ctd\u003e1\u003c/td\u003e\n","      \u003ctd\u003e‡§Æ‡•á‡§∞‡•á ‡§¶‡•á‡§∂ ‡§ï‡•á ‡§π‡§ø‡§®‡•ç‡§¶‡•Å ‡§¨‡§π‡•Å‡§§ ‡§®‡§ø‡§∞‡§æ‡§≤‡•á ‡§π‡•à‡•§ ‡§ï‡•Å‡§õ ‡§§‡•ã ‡§™‡§ï‡•ç‡§ï‡•á ‡§∞‡§æ‡§Æ ‡§≠‡§ï‡•ç‡§§ ‡§π‡•à ‡§î‡§∞ ‡§ï‡•Å‡§õ ‡§¨‡§æ‡§¨‡§∞ ‡§ï‡•á ‡§∏‡§æ‡§≤‡•á ‡§π‡•à \\n\\n ‡§ú‡§Ø ‡§∂‡•ç‡§∞‡•Ä ...\u003c/td\u003e\n","      \u003ctd\u003ehate,offensive\u003c/td\u003e\n","    \u003c/tr\u003e\n","    \u003ctr\u003e\n","      \u003cth\u003e1\u003c/th\u003e\n","      \u003ctd\u003e2\u003c/td\u003e\n","      \u003ctd\u003e‡§∏‡§∞‡§ï‡§æ‡§∞ ‡§π‡§Æ‡•á‡§∂‡§æ ‡§∏‡•á ‡§ï‡§ø‡§∏‡§æ‡§®‡•ã‡§Ç ‡§ï‡•Ä ‡§ï‡§Æ‡§æ‡§à ‡§ï‡•ã ‡§¨‡§¢‡§º‡§æ‡§®‡•á ‡§ï‡•á ‡§≤‡§ø‡§è ‡§®‡§à-‡§®‡§à ‡§∏‡•ç‡§ï‡•Ä‡§Æ‡•á‡§Ç ‡§≤‡§æ‡§§‡•Ä ‡§∞‡§π‡§§‡•Ä ‡§π‡•à, ‡§§‡§æ‡§ï‡§ø ‡§â‡§® ‡§™‡§∞ ‡§ú‡•ç‡§Ø‡§æ‡§¶‡§æ ‡§Ü‡§∞...\u003c/td\u003e\n","      \u003ctd\u003enon-hostile\u003c/td\u003e\n","    \u003c/tr\u003e\n","    \u003ctr\u003e\n","      \u003cth\u003e2\u003c/th\u003e\n","      \u003ctd\u003e3\u003c/td\u003e\n","      \u003ctd\u003e‡§∏‡•Å‡§∂‡§æ‡§Ç‡§§ ‡§®‡•á ‡§ú‡•ã ‡§¨‡§ø‡§ú‡§®‡•á‡§∏ ‡§°‡•Ä‡§≤  ‡§ú‡•Ç‡§® ‡§ï‡•ã ‡§ï‡•Ä ‡§•‡•Ä, ‡§µ‡•ã ‡§°‡•Ä‡§≤ ‡§¶‡•Ä‡§™‡•á‡§∂ ‡§ï‡•ã ‡§∏‡•Å‡§∂‡§æ‡§Ç‡§§ ‡§ï‡•Ä ‡§π‡§§‡•ç‡§Ø‡§æ ‡§ï‡•á ‡§¶‡§ø‡§® ‡§π‡•Ä ‡§ï‡•ç‡§Ø‡•ã‡§Ç ‡§Ø‡§æ‡§¶ ‡§Ü‡§à? ‡§¶...\u003c/td\u003e\n","      \u003ctd\u003enon-hostile\u003c/td\u003e\n","    \u003c/tr\u003e\n","    \u003ctr\u003e\n","      \u003cth\u003e3\u003c/th\u003e\n","      \u003ctd\u003e4\u003c/td\u003e\n","      \u003ctd\u003e@prabhav ‡§∏‡§æ‡§≤‡•á ‡§ú‡•á‡§è‡§®‡§Ø‡•Ç ‡§õ‡§æ‡§™ ‡§ï‡§Æ‡§ø‡§®‡•á ‡§≤‡•ã‡§ó ‡§π‡§ø‡§®‡•ç‡§¶‡•Å‡§ì‡§Ç ‡§ï‡•ã ‡§Ø‡§π ‡§ï‡§π‡§§‡•á ‡§π‡•à ‡§ï‡•Ä ‡§∏‡§Ç‡§µ‡§ø‡§ß‡§æ‡§® ‡§∏‡§¨‡§ï‡•ã ‡§¨‡§∞‡§æ‡§¨‡§∞ ‡§Ö‡§ß‡§ø‡§ï‡§æ‡§∞ ‡§¶‡•á‡§§‡§æ ‡§π‡•à‡•§ ...\u003c/td\u003e\n","      \u003ctd\u003edefamation,offensive\u003c/td\u003e\n","    \u003c/tr\u003e\n","    \u003ctr\u003e\n","      \u003cth\u003e4\u003c/th\u003e\n","      \u003ctd\u003e5\u003c/td\u003e\n","      \u003ctd\u003e#unlockguidelines - ‡§Ö‡§®‡§≤‡•â‡§ï- ‡§ï‡•á ‡§≤‡§ø‡§è ‡§ó‡§æ‡§á‡§°‡§≤‡§æ‡§á‡§®‡•ç‡§∏ ‡§ú‡§æ‡§∞‡•Ä\\n\\n-  ‡§∏‡§ø‡§§‡§Ç‡§¨‡§∞ ‡§∏‡•á ‡§¶‡•á‡§∂‡§≠‡§∞ ‡§Æ‡•á‡§Ç ‡§Æ‡•á‡§ü‡•ç‡§∞‡•ã ‡§∏‡•á‡§µ‡§æ ‡§∂‡•Å‡§∞‡•Å ‡§π‡•ã‡§ó...\u003c/td\u003e\n","      \u003ctd\u003enon-hostile\u003c/td\u003e\n","    \u003c/tr\u003e\n","  \u003c/tbody\u003e\n","\u003c/table\u003e\n","\u003c/div\u003e"],"text/plain":["   Unique ID  ...            Labels Set\n","0          1  ...        hate,offensive\n","1          2  ...           non-hostile\n","2          3  ...           non-hostile\n","3          4  ...  defamation,offensive\n","4          5  ...           non-hostile\n","\n","[5 rows x 3 columns]"]},"execution_count":9,"metadata":{"tags":[]},"output_type":"execute_result"}],"source":["#removing numbers\n","Data['Post']=Data['Post'].str.replace(r'\\d+','')\n","Data.head()"]},{"cell_type":"code","execution_count":10,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":56762,"status":"ok","timestamp":1604477547271,"user":{"displayName":"Ankit Mishra","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14Gj2-BPUB24Nb2m9nv0HdWn-cRfQoBp0ocGjhX-k=s64","userId":"11667803432738710858"},"user_tz":-330},"id":"oAfoN1XjVpEb","outputId":"5728338d-7115-41e7-a494-992625dca7d4"},"outputs":[{"data":{"text/plain":["['hate', 'offensive', 'non-hostile', 'defamation', 'fake']"]},"execution_count":10,"metadata":{"tags":[]},"output_type":"execute_result"}],"source":["list(Data['Labels Set'].str.split(',', expand=True).stack().unique())"]},{"cell_type":"code","execution_count":11,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":56757,"status":"ok","timestamp":1604477547275,"user":{"displayName":"Ankit Mishra","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14Gj2-BPUB24Nb2m9nv0HdWn-cRfQoBp0ocGjhX-k=s64","userId":"11667803432738710858"},"user_tz":-330},"id":"AwCtBRq4Wjlh","outputId":"1e3bb39e-724f-487d-8409-ed09692b12d1"},"outputs":[{"data":{"text/plain":["non-hostile    3050\n","fake           1144\n","hate            792\n","offensive       742\n","defamation      564\n","dtype: int64"]},"execution_count":11,"metadata":{"tags":[]},"output_type":"execute_result"}],"source":["Data['Labels Set'].str.split(',', expand=True).stack().value_counts()"]},{"cell_type":"code","execution_count":12,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":56754,"status":"ok","timestamp":1604477547282,"user":{"displayName":"Ankit Mishra","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14Gj2-BPUB24Nb2m9nv0HdWn-cRfQoBp0ocGjhX-k=s64","userId":"11667803432738710858"},"user_tz":-330},"id":"dejOOEDulx7F","outputId":"88d906d9-5b47-4ee0-d4d0-450740869802"},"outputs":[{"data":{"text/plain":["str"]},"execution_count":12,"metadata":{"tags":[]},"output_type":"execute_result"}],"source":["type(Data['Labels Set'].iloc[0])"]},{"cell_type":"code","execution_count":13,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":56796,"status":"ok","timestamp":1604477547333,"user":{"displayName":"Ankit Mishra","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14Gj2-BPUB24Nb2m9nv0HdWn-cRfQoBp0ocGjhX-k=s64","userId":"11667803432738710858"},"user_tz":-330},"id":"ADku8hWUlx2r","outputId":"0a1afff3-088b-426c-cd0b-f0c7aaac7f27"},"outputs":[{"name":"stdout","output_type":"stream","text":["['hate', 'offensive']\n"]}],"source":["def Convert(string): \n","    li = list(string.split(\",\")) \n","    return li \n","\n","str1 =Data['Labels Set'].iloc[0]\n","print(Convert(str1)) "]},{"cell_type":"code","execution_count":14,"metadata":{"executionInfo":{"elapsed":56791,"status":"ok","timestamp":1604477547336,"user":{"displayName":"Ankit Mishra","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14Gj2-BPUB24Nb2m9nv0HdWn-cRfQoBp0ocGjhX-k=s64","userId":"11667803432738710858"},"user_tz":-330},"id":"rAd6CcFIlx0A"},"outputs":[],"source":["#ast.literal_eval(Data['Labels Set'].iloc[0])"]},{"cell_type":"code","execution_count":15,"metadata":{"executionInfo":{"elapsed":56787,"status":"ok","timestamp":1604477547337,"user":{"displayName":"Ankit Mishra","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14Gj2-BPUB24Nb2m9nv0HdWn-cRfQoBp0ocGjhX-k=s64","userId":"11667803432738710858"},"user_tz":-330},"id":"WMyw78X5nRly"},"outputs":[],"source":["Data['label']=Data['Labels Set'].apply(lambda x:Convert(x))"]},{"cell_type":"code","execution_count":16,"metadata":{"colab":{"base_uri":"https://localhost:8080/","height":206},"executionInfo":{"elapsed":56779,"status":"ok","timestamp":1604477547340,"user":{"displayName":"Ankit Mishra","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14Gj2-BPUB24Nb2m9nv0HdWn-cRfQoBp0ocGjhX-k=s64","userId":"11667803432738710858"},"user_tz":-330},"id":"6KSbZYb_nRiv","outputId":"f36d735e-a13e-40d1-80ec-4f23f9ce22c5"},"outputs":[{"data":{"text/html":["\u003cdiv\u003e\n","\u003cstyle scoped\u003e\n","    .dataframe tbody tr th:only-of-type {\n","        vertical-align: middle;\n","    }\n","\n","    .dataframe tbody tr th {\n","        vertical-align: top;\n","    }\n","\n","    .dataframe thead th {\n","        text-align: right;\n","    }\n","\u003c/style\u003e\n","\u003ctable border=\"1\" class=\"dataframe\"\u003e\n","  \u003cthead\u003e\n","    \u003ctr style=\"text-align: right;\"\u003e\n","      \u003cth\u003e\u003c/th\u003e\n","      \u003cth\u003eUnique ID\u003c/th\u003e\n","      \u003cth\u003ePost\u003c/th\u003e\n","      \u003cth\u003eLabels Set\u003c/th\u003e\n","      \u003cth\u003elabel\u003c/th\u003e\n","    \u003c/tr\u003e\n","  \u003c/thead\u003e\n","  \u003ctbody\u003e\n","    \u003ctr\u003e\n","      \u003cth\u003e0\u003c/th\u003e\n","      \u003ctd\u003e1\u003c/td\u003e\n","      \u003ctd\u003e‡§Æ‡•á‡§∞‡•á ‡§¶‡•á‡§∂ ‡§ï‡•á ‡§π‡§ø‡§®‡•ç‡§¶‡•Å ‡§¨‡§π‡•Å‡§§ ‡§®‡§ø‡§∞‡§æ‡§≤‡•á ‡§π‡•à‡•§ ‡§ï‡•Å‡§õ ‡§§‡•ã ‡§™‡§ï‡•ç‡§ï‡•á ‡§∞‡§æ‡§Æ ‡§≠‡§ï‡•ç‡§§ ‡§π‡•à ‡§î‡§∞ ‡§ï‡•Å‡§õ ‡§¨‡§æ‡§¨‡§∞ ‡§ï‡•á ‡§∏‡§æ‡§≤‡•á ‡§π‡•à \\n\\n ‡§ú‡§Ø ‡§∂‡•ç‡§∞‡•Ä ...\u003c/td\u003e\n","      \u003ctd\u003ehate,offensive\u003c/td\u003e\n","      \u003ctd\u003e[hate, offensive]\u003c/td\u003e\n","    \u003c/tr\u003e\n","    \u003ctr\u003e\n","      \u003cth\u003e1\u003c/th\u003e\n","      \u003ctd\u003e2\u003c/td\u003e\n","      \u003ctd\u003e‡§∏‡§∞‡§ï‡§æ‡§∞ ‡§π‡§Æ‡•á‡§∂‡§æ ‡§∏‡•á ‡§ï‡§ø‡§∏‡§æ‡§®‡•ã‡§Ç ‡§ï‡•Ä ‡§ï‡§Æ‡§æ‡§à ‡§ï‡•ã ‡§¨‡§¢‡§º‡§æ‡§®‡•á ‡§ï‡•á ‡§≤‡§ø‡§è ‡§®‡§à-‡§®‡§à ‡§∏‡•ç‡§ï‡•Ä‡§Æ‡•á‡§Ç ‡§≤‡§æ‡§§‡•Ä ‡§∞‡§π‡§§‡•Ä ‡§π‡•à, ‡§§‡§æ‡§ï‡§ø ‡§â‡§® ‡§™‡§∞ ‡§ú‡•ç‡§Ø‡§æ‡§¶‡§æ ‡§Ü‡§∞...\u003c/td\u003e\n","      \u003ctd\u003enon-hostile\u003c/td\u003e\n","      \u003ctd\u003e[non-hostile]\u003c/td\u003e\n","    \u003c/tr\u003e\n","    \u003ctr\u003e\n","      \u003cth\u003e2\u003c/th\u003e\n","      \u003ctd\u003e3\u003c/td\u003e\n","      \u003ctd\u003e‡§∏‡•Å‡§∂‡§æ‡§Ç‡§§ ‡§®‡•á ‡§ú‡•ã ‡§¨‡§ø‡§ú‡§®‡•á‡§∏ ‡§°‡•Ä‡§≤  ‡§ú‡•Ç‡§® ‡§ï‡•ã ‡§ï‡•Ä ‡§•‡•Ä, ‡§µ‡•ã ‡§°‡•Ä‡§≤ ‡§¶‡•Ä‡§™‡•á‡§∂ ‡§ï‡•ã ‡§∏‡•Å‡§∂‡§æ‡§Ç‡§§ ‡§ï‡•Ä ‡§π‡§§‡•ç‡§Ø‡§æ ‡§ï‡•á ‡§¶‡§ø‡§® ‡§π‡•Ä ‡§ï‡•ç‡§Ø‡•ã‡§Ç ‡§Ø‡§æ‡§¶ ‡§Ü‡§à? ‡§¶...\u003c/td\u003e\n","      \u003ctd\u003enon-hostile\u003c/td\u003e\n","      \u003ctd\u003e[non-hostile]\u003c/td\u003e\n","    \u003c/tr\u003e\n","    \u003ctr\u003e\n","      \u003cth\u003e3\u003c/th\u003e\n","      \u003ctd\u003e4\u003c/td\u003e\n","      \u003ctd\u003e@prabhav ‡§∏‡§æ‡§≤‡•á ‡§ú‡•á‡§è‡§®‡§Ø‡•Ç ‡§õ‡§æ‡§™ ‡§ï‡§Æ‡§ø‡§®‡•á ‡§≤‡•ã‡§ó ‡§π‡§ø‡§®‡•ç‡§¶‡•Å‡§ì‡§Ç ‡§ï‡•ã ‡§Ø‡§π ‡§ï‡§π‡§§‡•á ‡§π‡•à ‡§ï‡•Ä ‡§∏‡§Ç‡§µ‡§ø‡§ß‡§æ‡§® ‡§∏‡§¨‡§ï‡•ã ‡§¨‡§∞‡§æ‡§¨‡§∞ ‡§Ö‡§ß‡§ø‡§ï‡§æ‡§∞ ‡§¶‡•á‡§§‡§æ ‡§π‡•à‡•§ ...\u003c/td\u003e\n","      \u003ctd\u003edefamation,offensive\u003c/td\u003e\n","      \u003ctd\u003e[defamation, offensive]\u003c/td\u003e\n","    \u003c/tr\u003e\n","    \u003ctr\u003e\n","      \u003cth\u003e4\u003c/th\u003e\n","      \u003ctd\u003e5\u003c/td\u003e\n","      \u003ctd\u003e#unlockguidelines - ‡§Ö‡§®‡§≤‡•â‡§ï- ‡§ï‡•á ‡§≤‡§ø‡§è ‡§ó‡§æ‡§á‡§°‡§≤‡§æ‡§á‡§®‡•ç‡§∏ ‡§ú‡§æ‡§∞‡•Ä\\n\\n-  ‡§∏‡§ø‡§§‡§Ç‡§¨‡§∞ ‡§∏‡•á ‡§¶‡•á‡§∂‡§≠‡§∞ ‡§Æ‡•á‡§Ç ‡§Æ‡•á‡§ü‡•ç‡§∞‡•ã ‡§∏‡•á‡§µ‡§æ ‡§∂‡•Å‡§∞‡•Å ‡§π‡•ã‡§ó...\u003c/td\u003e\n","      \u003ctd\u003enon-hostile\u003c/td\u003e\n","      \u003ctd\u003e[non-hostile]\u003c/td\u003e\n","    \u003c/tr\u003e\n","  \u003c/tbody\u003e\n","\u003c/table\u003e\n","\u003c/div\u003e"],"text/plain":["   Unique ID  ...                    label\n","0          1  ...        [hate, offensive]\n","1          2  ...            [non-hostile]\n","2          3  ...            [non-hostile]\n","3          4  ...  [defamation, offensive]\n","4          5  ...            [non-hostile]\n","\n","[5 rows x 4 columns]"]},"execution_count":16,"metadata":{"tags":[]},"output_type":"execute_result"}],"source":["Data.head()"]},{"cell_type":"code","execution_count":16,"metadata":{"executionInfo":{"elapsed":56779,"status":"ok","timestamp":1604477547344,"user":{"displayName":"Ankit Mishra","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14Gj2-BPUB24Nb2m9nv0HdWn-cRfQoBp0ocGjhX-k=s64","userId":"11667803432738710858"},"user_tz":-330},"id":"KBr2CSFplxv7"},"outputs":[],"source":[""]},{"cell_type":"code","execution_count":17,"metadata":{"executionInfo":{"elapsed":56780,"status":"ok","timestamp":1604477547349,"user":{"displayName":"Ankit Mishra","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14Gj2-BPUB24Nb2m9nv0HdWn-cRfQoBp0ocGjhX-k=s64","userId":"11667803432738710858"},"user_tz":-330},"id":"gbDl_XzlWjdK"},"outputs":[],"source":["from sklearn.preprocessing import MultiLabelBinarizer\n","from sklearn.multiclass import OneVsRestClassifier"]},{"cell_type":"code","execution_count":18,"metadata":{"executionInfo":{"elapsed":56777,"status":"ok","timestamp":1604477547350,"user":{"displayName":"Ankit Mishra","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14Gj2-BPUB24Nb2m9nv0HdWn-cRfQoBp0ocGjhX-k=s64","userId":"11667803432738710858"},"user_tz":-330},"id":"LcchW3uVWjaD"},"outputs":[],"source":["multilabel= MultiLabelBinarizer()"]},{"cell_type":"code","execution_count":19,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":56781,"status":"ok","timestamp":1604477547363,"user":{"displayName":"Ankit Mishra","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14Gj2-BPUB24Nb2m9nv0HdWn-cRfQoBp0ocGjhX-k=s64","userId":"11667803432738710858"},"user_tz":-330},"id":"zsttyb-xkOeF","outputId":"027bd655-2c7d-44fa-eeed-e70ee0ac69a8"},"outputs":[{"data":{"text/plain":["array([[0, 0, 1, 0, 1],\n","       [0, 0, 0, 1, 0],\n","       [0, 0, 0, 1, 0],\n","       ...,\n","       [0, 0, 0, 1, 0],\n","       [0, 1, 0, 0, 0],\n","       [0, 0, 0, 1, 0]])"]},"execution_count":19,"metadata":{"tags":[]},"output_type":"execute_result"}],"source":["label=multilabel.fit_transform(Data['label'])\n","label"]},{"cell_type":"code","execution_count":20,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":56776,"status":"ok","timestamp":1604477547366,"user":{"displayName":"Ankit Mishra","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14Gj2-BPUB24Nb2m9nv0HdWn-cRfQoBp0ocGjhX-k=s64","userId":"11667803432738710858"},"user_tz":-330},"id":"efCGgBG2kdwO","outputId":"c5ae867e-c7c5-4d1e-b683-05adbf6896c9"},"outputs":[{"data":{"text/plain":["array(['defamation', 'fake', 'hate', 'non-hostile', 'offensive'],\n","      dtype=object)"]},"execution_count":20,"metadata":{"tags":[]},"output_type":"execute_result"}],"source":["multilabel.classes_"]},{"cell_type":"code","execution_count":21,"metadata":{"colab":{"base_uri":"https://localhost:8080/","height":206},"executionInfo":{"elapsed":56768,"status":"ok","timestamp":1604477547369,"user":{"displayName":"Ankit Mishra","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14Gj2-BPUB24Nb2m9nv0HdWn-cRfQoBp0ocGjhX-k=s64","userId":"11667803432738710858"},"user_tz":-330},"id":"HLAvSeWvkoT9","outputId":"d808c5f6-4f09-46f6-9c09-40e456e81518"},"outputs":[{"data":{"text/html":["\u003cdiv\u003e\n","\u003cstyle scoped\u003e\n","    .dataframe tbody tr th:only-of-type {\n","        vertical-align: middle;\n","    }\n","\n","    .dataframe tbody tr th {\n","        vertical-align: top;\n","    }\n","\n","    .dataframe thead th {\n","        text-align: right;\n","    }\n","\u003c/style\u003e\n","\u003ctable border=\"1\" class=\"dataframe\"\u003e\n","  \u003cthead\u003e\n","    \u003ctr style=\"text-align: right;\"\u003e\n","      \u003cth\u003e\u003c/th\u003e\n","      \u003cth\u003edefamation\u003c/th\u003e\n","      \u003cth\u003efake\u003c/th\u003e\n","      \u003cth\u003ehate\u003c/th\u003e\n","      \u003cth\u003enon-hostile\u003c/th\u003e\n","      \u003cth\u003eoffensive\u003c/th\u003e\n","    \u003c/tr\u003e\n","  \u003c/thead\u003e\n","  \u003ctbody\u003e\n","    \u003ctr\u003e\n","      \u003cth\u003e0\u003c/th\u003e\n","      \u003ctd\u003e0\u003c/td\u003e\n","      \u003ctd\u003e0\u003c/td\u003e\n","      \u003ctd\u003e1\u003c/td\u003e\n","      \u003ctd\u003e0\u003c/td\u003e\n","      \u003ctd\u003e1\u003c/td\u003e\n","    \u003c/tr\u003e\n","    \u003ctr\u003e\n","      \u003cth\u003e1\u003c/th\u003e\n","      \u003ctd\u003e0\u003c/td\u003e\n","      \u003ctd\u003e0\u003c/td\u003e\n","      \u003ctd\u003e0\u003c/td\u003e\n","      \u003ctd\u003e1\u003c/td\u003e\n","      \u003ctd\u003e0\u003c/td\u003e\n","    \u003c/tr\u003e\n","    \u003ctr\u003e\n","      \u003cth\u003e2\u003c/th\u003e\n","      \u003ctd\u003e0\u003c/td\u003e\n","      \u003ctd\u003e0\u003c/td\u003e\n","      \u003ctd\u003e0\u003c/td\u003e\n","      \u003ctd\u003e1\u003c/td\u003e\n","      \u003ctd\u003e0\u003c/td\u003e\n","    \u003c/tr\u003e\n","    \u003ctr\u003e\n","      \u003cth\u003e3\u003c/th\u003e\n","      \u003ctd\u003e1\u003c/td\u003e\n","      \u003ctd\u003e0\u003c/td\u003e\n","      \u003ctd\u003e0\u003c/td\u003e\n","      \u003ctd\u003e0\u003c/td\u003e\n","      \u003ctd\u003e1\u003c/td\u003e\n","    \u003c/tr\u003e\n","    \u003ctr\u003e\n","      \u003cth\u003e4\u003c/th\u003e\n","      \u003ctd\u003e0\u003c/td\u003e\n","      \u003ctd\u003e0\u003c/td\u003e\n","      \u003ctd\u003e0\u003c/td\u003e\n","      \u003ctd\u003e1\u003c/td\u003e\n","      \u003ctd\u003e0\u003c/td\u003e\n","    \u003c/tr\u003e\n","  \u003c/tbody\u003e\n","\u003c/table\u003e\n","\u003c/div\u003e"],"text/plain":["   defamation  fake  hate  non-hostile  offensive\n","0           0     0     1            0          1\n","1           0     0     0            1          0\n","2           0     0     0            1          0\n","3           1     0     0            0          1\n","4           0     0     0            1          0"]},"execution_count":21,"metadata":{"tags":[]},"output_type":"execute_result"}],"source":["Data2=pd.DataFrame(label,columns=multilabel.classes_)\n","Data2.head()"]},{"cell_type":"code","execution_count":22,"metadata":{"colab":{"base_uri":"https://localhost:8080/","height":293},"executionInfo":{"elapsed":56758,"status":"ok","timestamp":1604477547370,"user":{"displayName":"Ankit Mishra","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14Gj2-BPUB24Nb2m9nv0HdWn-cRfQoBp0ocGjhX-k=s64","userId":"11667803432738710858"},"user_tz":-330},"id":"ANBcxpY4dlCm","outputId":"6231c2b4-26bd-42ab-afb0-691187207249"},"outputs":[{"data":{"text/html":["\u003cdiv\u003e\n","\u003cstyle scoped\u003e\n","    .dataframe tbody tr th:only-of-type {\n","        vertical-align: middle;\n","    }\n","\n","    .dataframe tbody tr th {\n","        vertical-align: top;\n","    }\n","\n","    .dataframe thead th {\n","        text-align: right;\n","    }\n","\u003c/style\u003e\n","\u003ctable border=\"1\" class=\"dataframe\"\u003e\n","  \u003cthead\u003e\n","    \u003ctr style=\"text-align: right;\"\u003e\n","      \u003cth\u003e\u003c/th\u003e\n","      \u003cth\u003eUnique ID\u003c/th\u003e\n","      \u003cth\u003ePost\u003c/th\u003e\n","      \u003cth\u003eLabels Set\u003c/th\u003e\n","      \u003cth\u003elabel\u003c/th\u003e\n","      \u003cth\u003edefamation\u003c/th\u003e\n","      \u003cth\u003efake\u003c/th\u003e\n","      \u003cth\u003ehate\u003c/th\u003e\n","      \u003cth\u003enon-hostile\u003c/th\u003e\n","      \u003cth\u003eoffensive\u003c/th\u003e\n","    \u003c/tr\u003e\n","  \u003c/thead\u003e\n","  \u003ctbody\u003e\n","    \u003ctr\u003e\n","      \u003cth\u003e0\u003c/th\u003e\n","      \u003ctd\u003e1\u003c/td\u003e\n","      \u003ctd\u003e‡§Æ‡•á‡§∞‡•á ‡§¶‡•á‡§∂ ‡§ï‡•á ‡§π‡§ø‡§®‡•ç‡§¶‡•Å ‡§¨‡§π‡•Å‡§§ ‡§®‡§ø‡§∞‡§æ‡§≤‡•á ‡§π‡•à‡•§ ‡§ï‡•Å‡§õ ‡§§‡•ã ‡§™‡§ï‡•ç‡§ï‡•á ‡§∞‡§æ‡§Æ ‡§≠‡§ï‡•ç‡§§ ‡§π‡•à ‡§î‡§∞ ‡§ï‡•Å‡§õ ‡§¨‡§æ‡§¨‡§∞ ‡§ï‡•á ‡§∏‡§æ‡§≤‡•á ‡§π‡•à \\n\\n ‡§ú‡§Ø ‡§∂‡•ç‡§∞‡•Ä ...\u003c/td\u003e\n","      \u003ctd\u003ehate,offensive\u003c/td\u003e\n","      \u003ctd\u003e[hate, offensive]\u003c/td\u003e\n","      \u003ctd\u003e0\u003c/td\u003e\n","      \u003ctd\u003e0\u003c/td\u003e\n","      \u003ctd\u003e1\u003c/td\u003e\n","      \u003ctd\u003e0\u003c/td\u003e\n","      \u003ctd\u003e1\u003c/td\u003e\n","    \u003c/tr\u003e\n","    \u003ctr\u003e\n","      \u003cth\u003e1\u003c/th\u003e\n","      \u003ctd\u003e2\u003c/td\u003e\n","      \u003ctd\u003e‡§∏‡§∞‡§ï‡§æ‡§∞ ‡§π‡§Æ‡•á‡§∂‡§æ ‡§∏‡•á ‡§ï‡§ø‡§∏‡§æ‡§®‡•ã‡§Ç ‡§ï‡•Ä ‡§ï‡§Æ‡§æ‡§à ‡§ï‡•ã ‡§¨‡§¢‡§º‡§æ‡§®‡•á ‡§ï‡•á ‡§≤‡§ø‡§è ‡§®‡§à-‡§®‡§à ‡§∏‡•ç‡§ï‡•Ä‡§Æ‡•á‡§Ç ‡§≤‡§æ‡§§‡•Ä ‡§∞‡§π‡§§‡•Ä ‡§π‡•à, ‡§§‡§æ‡§ï‡§ø ‡§â‡§® ‡§™‡§∞ ‡§ú‡•ç‡§Ø‡§æ‡§¶‡§æ ‡§Ü‡§∞...\u003c/td\u003e\n","      \u003ctd\u003enon-hostile\u003c/td\u003e\n","      \u003ctd\u003e[non-hostile]\u003c/td\u003e\n","      \u003ctd\u003e0\u003c/td\u003e\n","      \u003ctd\u003e0\u003c/td\u003e\n","      \u003ctd\u003e0\u003c/td\u003e\n","      \u003ctd\u003e1\u003c/td\u003e\n","      \u003ctd\u003e0\u003c/td\u003e\n","    \u003c/tr\u003e\n","    \u003ctr\u003e\n","      \u003cth\u003e2\u003c/th\u003e\n","      \u003ctd\u003e3\u003c/td\u003e\n","      \u003ctd\u003e‡§∏‡•Å‡§∂‡§æ‡§Ç‡§§ ‡§®‡•á ‡§ú‡•ã ‡§¨‡§ø‡§ú‡§®‡•á‡§∏ ‡§°‡•Ä‡§≤  ‡§ú‡•Ç‡§® ‡§ï‡•ã ‡§ï‡•Ä ‡§•‡•Ä, ‡§µ‡•ã ‡§°‡•Ä‡§≤ ‡§¶‡•Ä‡§™‡•á‡§∂ ‡§ï‡•ã ‡§∏‡•Å‡§∂‡§æ‡§Ç‡§§ ‡§ï‡•Ä ‡§π‡§§‡•ç‡§Ø‡§æ ‡§ï‡•á ‡§¶‡§ø‡§® ‡§π‡•Ä ‡§ï‡•ç‡§Ø‡•ã‡§Ç ‡§Ø‡§æ‡§¶ ‡§Ü‡§à? ‡§¶...\u003c/td\u003e\n","      \u003ctd\u003enon-hostile\u003c/td\u003e\n","      \u003ctd\u003e[non-hostile]\u003c/td\u003e\n","      \u003ctd\u003e0\u003c/td\u003e\n","      \u003ctd\u003e0\u003c/td\u003e\n","      \u003ctd\u003e0\u003c/td\u003e\n","      \u003ctd\u003e1\u003c/td\u003e\n","      \u003ctd\u003e0\u003c/td\u003e\n","    \u003c/tr\u003e\n","    \u003ctr\u003e\n","      \u003cth\u003e3\u003c/th\u003e\n","      \u003ctd\u003e4\u003c/td\u003e\n","      \u003ctd\u003e@prabhav ‡§∏‡§æ‡§≤‡•á ‡§ú‡•á‡§è‡§®‡§Ø‡•Ç ‡§õ‡§æ‡§™ ‡§ï‡§Æ‡§ø‡§®‡•á ‡§≤‡•ã‡§ó ‡§π‡§ø‡§®‡•ç‡§¶‡•Å‡§ì‡§Ç ‡§ï‡•ã ‡§Ø‡§π ‡§ï‡§π‡§§‡•á ‡§π‡•à ‡§ï‡•Ä ‡§∏‡§Ç‡§µ‡§ø‡§ß‡§æ‡§® ‡§∏‡§¨‡§ï‡•ã ‡§¨‡§∞‡§æ‡§¨‡§∞ ‡§Ö‡§ß‡§ø‡§ï‡§æ‡§∞ ‡§¶‡•á‡§§‡§æ ‡§π‡•à‡•§ ...\u003c/td\u003e\n","      \u003ctd\u003edefamation,offensive\u003c/td\u003e\n","      \u003ctd\u003e[defamation, offensive]\u003c/td\u003e\n","      \u003ctd\u003e1\u003c/td\u003e\n","      \u003ctd\u003e0\u003c/td\u003e\n","      \u003ctd\u003e0\u003c/td\u003e\n","      \u003ctd\u003e0\u003c/td\u003e\n","      \u003ctd\u003e1\u003c/td\u003e\n","    \u003c/tr\u003e\n","    \u003ctr\u003e\n","      \u003cth\u003e4\u003c/th\u003e\n","      \u003ctd\u003e5\u003c/td\u003e\n","      \u003ctd\u003e#unlockguidelines - ‡§Ö‡§®‡§≤‡•â‡§ï- ‡§ï‡•á ‡§≤‡§ø‡§è ‡§ó‡§æ‡§á‡§°‡§≤‡§æ‡§á‡§®‡•ç‡§∏ ‡§ú‡§æ‡§∞‡•Ä\\n\\n-  ‡§∏‡§ø‡§§‡§Ç‡§¨‡§∞ ‡§∏‡•á ‡§¶‡•á‡§∂‡§≠‡§∞ ‡§Æ‡•á‡§Ç ‡§Æ‡•á‡§ü‡•ç‡§∞‡•ã ‡§∏‡•á‡§µ‡§æ ‡§∂‡•Å‡§∞‡•Å ‡§π‡•ã‡§ó...\u003c/td\u003e\n","      \u003ctd\u003enon-hostile\u003c/td\u003e\n","      \u003ctd\u003e[non-hostile]\u003c/td\u003e\n","      \u003ctd\u003e0\u003c/td\u003e\n","      \u003ctd\u003e0\u003c/td\u003e\n","      \u003ctd\u003e0\u003c/td\u003e\n","      \u003ctd\u003e1\u003c/td\u003e\n","      \u003ctd\u003e0\u003c/td\u003e\n","    \u003c/tr\u003e\n","  \u003c/tbody\u003e\n","\u003c/table\u003e\n","\u003c/div\u003e"],"text/plain":["   Unique ID  ... offensive\n","0          1  ...         1\n","1          2  ...         0\n","2          3  ...         0\n","3          4  ...         1\n","4          5  ...         0\n","\n","[5 rows x 9 columns]"]},"execution_count":22,"metadata":{"tags":[]},"output_type":"execute_result"}],"source":["DATA = pd.concat([Data,Data2.reindex(Data.index)],axis=1)\n","DATA.head()"]},{"cell_type":"code","execution_count":23,"metadata":{"colab":{"base_uri":"https://localhost:8080/","height":317},"executionInfo":{"elapsed":56808,"status":"ok","timestamp":1604477547429,"user":{"displayName":"Ankit Mishra","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14Gj2-BPUB24Nb2m9nv0HdWn-cRfQoBp0ocGjhX-k=s64","userId":"11667803432738710858"},"user_tz":-330},"id":"vERK_NqydlNi","outputId":"5efb55d8-f63b-4329-8b5a-ccfe044d238d"},"outputs":[{"name":"stderr","output_type":"stream","text":["/usr/local/lib/python3.6/dist-packages/ipykernel_launcher.py:2: SettingWithCopyWarning: \n","A value is trying to be set on a copy of a slice from a DataFrame.\n","Try using .loc[row_indexer,col_indexer] = value instead\n","\n","See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy\n","  \n"]},{"data":{"text/html":["\u003cdiv\u003e\n","\u003cstyle scoped\u003e\n","    .dataframe tbody tr th:only-of-type {\n","        vertical-align: middle;\n","    }\n","\n","    .dataframe tbody tr th {\n","        vertical-align: top;\n","    }\n","\n","    .dataframe thead th {\n","        text-align: right;\n","    }\n","\u003c/style\u003e\n","\u003ctable border=\"1\" class=\"dataframe\"\u003e\n","  \u003cthead\u003e\n","    \u003ctr style=\"text-align: right;\"\u003e\n","      \u003cth\u003e\u003c/th\u003e\n","      \u003cth\u003ePost\u003c/th\u003e\n","      \u003cth\u003elabel\u003c/th\u003e\n","      \u003cth\u003enon-hostile\u003c/th\u003e\n","    \u003c/tr\u003e\n","  \u003c/thead\u003e\n","  \u003ctbody\u003e\n","    \u003ctr\u003e\n","      \u003cth\u003e0\u003c/th\u003e\n","      \u003ctd\u003e‡§Æ‡•á‡§∞‡•á ‡§¶‡•á‡§∂ ‡§ï‡•á ‡§π‡§ø‡§®‡•ç‡§¶‡•Å ‡§¨‡§π‡•Å‡§§ ‡§®‡§ø‡§∞‡§æ‡§≤‡•á ‡§π‡•à‡•§ ‡§ï‡•Å‡§õ ‡§§‡•ã ‡§™‡§ï‡•ç‡§ï‡•á ‡§∞‡§æ‡§Æ ‡§≠‡§ï‡•ç‡§§ ‡§π‡•à ‡§î‡§∞ ‡§ï‡•Å‡§õ ‡§¨‡§æ‡§¨‡§∞ ‡§ï‡•á ‡§∏‡§æ‡§≤‡•á ‡§π‡•à \\n\\n ‡§ú‡§Ø ‡§∂‡•ç‡§∞‡•Ä ...\u003c/td\u003e\n","      \u003ctd\u003e[hate, offensive]\u003c/td\u003e\n","      \u003ctd\u003e0.0\u003c/td\u003e\n","    \u003c/tr\u003e\n","    \u003ctr\u003e\n","      \u003cth\u003e1\u003c/th\u003e\n","      \u003ctd\u003e‡§∏‡§∞‡§ï‡§æ‡§∞ ‡§π‡§Æ‡•á‡§∂‡§æ ‡§∏‡•á ‡§ï‡§ø‡§∏‡§æ‡§®‡•ã‡§Ç ‡§ï‡•Ä ‡§ï‡§Æ‡§æ‡§à ‡§ï‡•ã ‡§¨‡§¢‡§º‡§æ‡§®‡•á ‡§ï‡•á ‡§≤‡§ø‡§è ‡§®‡§à-‡§®‡§à ‡§∏‡•ç‡§ï‡•Ä‡§Æ‡•á‡§Ç ‡§≤‡§æ‡§§‡•Ä ‡§∞‡§π‡§§‡•Ä ‡§π‡•à, ‡§§‡§æ‡§ï‡§ø ‡§â‡§® ‡§™‡§∞ ‡§ú‡•ç‡§Ø‡§æ‡§¶‡§æ ‡§Ü‡§∞...\u003c/td\u003e\n","      \u003ctd\u003e[non-hostile]\u003c/td\u003e\n","      \u003ctd\u003e1.0\u003c/td\u003e\n","    \u003c/tr\u003e\n","    \u003ctr\u003e\n","      \u003cth\u003e2\u003c/th\u003e\n","      \u003ctd\u003e‡§∏‡•Å‡§∂‡§æ‡§Ç‡§§ ‡§®‡•á ‡§ú‡•ã ‡§¨‡§ø‡§ú‡§®‡•á‡§∏ ‡§°‡•Ä‡§≤  ‡§ú‡•Ç‡§® ‡§ï‡•ã ‡§ï‡•Ä ‡§•‡•Ä, ‡§µ‡•ã ‡§°‡•Ä‡§≤ ‡§¶‡•Ä‡§™‡•á‡§∂ ‡§ï‡•ã ‡§∏‡•Å‡§∂‡§æ‡§Ç‡§§ ‡§ï‡•Ä ‡§π‡§§‡•ç‡§Ø‡§æ ‡§ï‡•á ‡§¶‡§ø‡§® ‡§π‡•Ä ‡§ï‡•ç‡§Ø‡•ã‡§Ç ‡§Ø‡§æ‡§¶ ‡§Ü‡§à? ‡§¶...\u003c/td\u003e\n","      \u003ctd\u003e[non-hostile]\u003c/td\u003e\n","      \u003ctd\u003e1.0\u003c/td\u003e\n","    \u003c/tr\u003e\n","    \u003ctr\u003e\n","      \u003cth\u003e3\u003c/th\u003e\n","      \u003ctd\u003e@prabhav ‡§∏‡§æ‡§≤‡•á ‡§ú‡•á‡§è‡§®‡§Ø‡•Ç ‡§õ‡§æ‡§™ ‡§ï‡§Æ‡§ø‡§®‡•á ‡§≤‡•ã‡§ó ‡§π‡§ø‡§®‡•ç‡§¶‡•Å‡§ì‡§Ç ‡§ï‡•ã ‡§Ø‡§π ‡§ï‡§π‡§§‡•á ‡§π‡•à ‡§ï‡•Ä ‡§∏‡§Ç‡§µ‡§ø‡§ß‡§æ‡§® ‡§∏‡§¨‡§ï‡•ã ‡§¨‡§∞‡§æ‡§¨‡§∞ ‡§Ö‡§ß‡§ø‡§ï‡§æ‡§∞ ‡§¶‡•á‡§§‡§æ ‡§π‡•à‡•§ ...\u003c/td\u003e\n","      \u003ctd\u003e[defamation, offensive]\u003c/td\u003e\n","      \u003ctd\u003e0.0\u003c/td\u003e\n","    \u003c/tr\u003e\n","    \u003ctr\u003e\n","      \u003cth\u003e4\u003c/th\u003e\n","      \u003ctd\u003e#unlockguidelines - ‡§Ö‡§®‡§≤‡•â‡§ï- ‡§ï‡•á ‡§≤‡§ø‡§è ‡§ó‡§æ‡§á‡§°‡§≤‡§æ‡§á‡§®‡•ç‡§∏ ‡§ú‡§æ‡§∞‡•Ä\\n\\n-  ‡§∏‡§ø‡§§‡§Ç‡§¨‡§∞ ‡§∏‡•á ‡§¶‡•á‡§∂‡§≠‡§∞ ‡§Æ‡•á‡§Ç ‡§Æ‡•á‡§ü‡•ç‡§∞‡•ã ‡§∏‡•á‡§µ‡§æ ‡§∂‡•Å‡§∞‡•Å ‡§π‡•ã‡§ó...\u003c/td\u003e\n","      \u003ctd\u003e[non-hostile]\u003c/td\u003e\n","      \u003ctd\u003e1.0\u003c/td\u003e\n","    \u003c/tr\u003e\n","  \u003c/tbody\u003e\n","\u003c/table\u003e\n","\u003c/div\u003e"],"text/plain":["                                                                                                  Post  ... non-hostile\n","0  ‡§Æ‡•á‡§∞‡•á ‡§¶‡•á‡§∂ ‡§ï‡•á ‡§π‡§ø‡§®‡•ç‡§¶‡•Å ‡§¨‡§π‡•Å‡§§ ‡§®‡§ø‡§∞‡§æ‡§≤‡•á ‡§π‡•à‡•§ ‡§ï‡•Å‡§õ ‡§§‡•ã ‡§™‡§ï‡•ç‡§ï‡•á ‡§∞‡§æ‡§Æ ‡§≠‡§ï‡•ç‡§§ ‡§π‡•à ‡§î‡§∞ ‡§ï‡•Å‡§õ ‡§¨‡§æ‡§¨‡§∞ ‡§ï‡•á ‡§∏‡§æ‡§≤‡•á ‡§π‡•à \\n\\n ‡§ú‡§Ø ‡§∂‡•ç‡§∞‡•Ä ...  ...         0.0\n","1  ‡§∏‡§∞‡§ï‡§æ‡§∞ ‡§π‡§Æ‡•á‡§∂‡§æ ‡§∏‡•á ‡§ï‡§ø‡§∏‡§æ‡§®‡•ã‡§Ç ‡§ï‡•Ä ‡§ï‡§Æ‡§æ‡§à ‡§ï‡•ã ‡§¨‡§¢‡§º‡§æ‡§®‡•á ‡§ï‡•á ‡§≤‡§ø‡§è ‡§®‡§à-‡§®‡§à ‡§∏‡•ç‡§ï‡•Ä‡§Æ‡•á‡§Ç ‡§≤‡§æ‡§§‡•Ä ‡§∞‡§π‡§§‡•Ä ‡§π‡•à, ‡§§‡§æ‡§ï‡§ø ‡§â‡§® ‡§™‡§∞ ‡§ú‡•ç‡§Ø‡§æ‡§¶‡§æ ‡§Ü‡§∞...  ...         1.0\n","2  ‡§∏‡•Å‡§∂‡§æ‡§Ç‡§§ ‡§®‡•á ‡§ú‡•ã ‡§¨‡§ø‡§ú‡§®‡•á‡§∏ ‡§°‡•Ä‡§≤  ‡§ú‡•Ç‡§® ‡§ï‡•ã ‡§ï‡•Ä ‡§•‡•Ä, ‡§µ‡•ã ‡§°‡•Ä‡§≤ ‡§¶‡•Ä‡§™‡•á‡§∂ ‡§ï‡•ã ‡§∏‡•Å‡§∂‡§æ‡§Ç‡§§ ‡§ï‡•Ä ‡§π‡§§‡•ç‡§Ø‡§æ ‡§ï‡•á ‡§¶‡§ø‡§® ‡§π‡•Ä ‡§ï‡•ç‡§Ø‡•ã‡§Ç ‡§Ø‡§æ‡§¶ ‡§Ü‡§à? ‡§¶...  ...         1.0\n","3  @prabhav ‡§∏‡§æ‡§≤‡•á ‡§ú‡•á‡§è‡§®‡§Ø‡•Ç ‡§õ‡§æ‡§™ ‡§ï‡§Æ‡§ø‡§®‡•á ‡§≤‡•ã‡§ó ‡§π‡§ø‡§®‡•ç‡§¶‡•Å‡§ì‡§Ç ‡§ï‡•ã ‡§Ø‡§π ‡§ï‡§π‡§§‡•á ‡§π‡•à ‡§ï‡•Ä ‡§∏‡§Ç‡§µ‡§ø‡§ß‡§æ‡§® ‡§∏‡§¨‡§ï‡•ã ‡§¨‡§∞‡§æ‡§¨‡§∞ ‡§Ö‡§ß‡§ø‡§ï‡§æ‡§∞ ‡§¶‡•á‡§§‡§æ ‡§π‡•à‡•§ ...  ...         0.0\n","4  #unlockguidelines - ‡§Ö‡§®‡§≤‡•â‡§ï- ‡§ï‡•á ‡§≤‡§ø‡§è ‡§ó‡§æ‡§á‡§°‡§≤‡§æ‡§á‡§®‡•ç‡§∏ ‡§ú‡§æ‡§∞‡•Ä\\n\\n-  ‡§∏‡§ø‡§§‡§Ç‡§¨‡§∞ ‡§∏‡•á ‡§¶‡•á‡§∂‡§≠‡§∞ ‡§Æ‡•á‡§Ç ‡§Æ‡•á‡§ü‡•ç‡§∞‡•ã ‡§∏‡•á‡§µ‡§æ ‡§∂‡•Å‡§∞‡•Å ‡§π‡•ã‡§ó...  ...         1.0\n","\n","[5 rows x 3 columns]"]},"execution_count":23,"metadata":{"tags":[]},"output_type":"execute_result"}],"source":["data=DATA[['Post','label','non-hostile']]\n","data['non-hostile']=data['non-hostile'].astype(float)\n","data.head()"]},{"cell_type":"code","execution_count":23,"metadata":{"executionInfo":{"elapsed":56805,"status":"ok","timestamp":1604477547430,"user":{"displayName":"Ankit Mishra","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14Gj2-BPUB24Nb2m9nv0HdWn-cRfQoBp0ocGjhX-k=s64","userId":"11667803432738710858"},"user_tz":-330},"id":"RV3ZXqHjSta_"},"outputs":[],"source":[""]},{"cell_type":"code","execution_count":23,"metadata":{"executionInfo":{"elapsed":56803,"status":"ok","timestamp":1604477547432,"user":{"displayName":"Ankit Mishra","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14Gj2-BPUB24Nb2m9nv0HdWn-cRfQoBp0ocGjhX-k=s64","userId":"11667803432738710858"},"user_tz":-330},"id":"00SoSGU4StXk"},"outputs":[],"source":[""]},{"cell_type":"code","execution_count":23,"metadata":{"executionInfo":{"elapsed":56812,"status":"ok","timestamp":1604477547444,"user":{"displayName":"Ankit Mishra","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14Gj2-BPUB24Nb2m9nv0HdWn-cRfQoBp0ocGjhX-k=s64","userId":"11667803432738710858"},"user_tz":-330},"id":"Z1NIq_exStSQ"},"outputs":[],"source":[""]},{"cell_type":"code","execution_count":23,"metadata":{"executionInfo":{"elapsed":56811,"status":"ok","timestamp":1604477547446,"user":{"displayName":"Ankit Mishra","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14Gj2-BPUB24Nb2m9nv0HdWn-cRfQoBp0ocGjhX-k=s64","userId":"11667803432738710858"},"user_tz":-330},"id":"jxKKC3CzStOj"},"outputs":[],"source":[""]},{"cell_type":"code","execution_count":23,"metadata":{"executionInfo":{"elapsed":56809,"status":"ok","timestamp":1604477547448,"user":{"displayName":"Ankit Mishra","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14Gj2-BPUB24Nb2m9nv0HdWn-cRfQoBp0ocGjhX-k=s64","userId":"11667803432738710858"},"user_tz":-330},"id":"AcdHCqspcsDP"},"outputs":[],"source":[""]},{"cell_type":"code","execution_count":23,"metadata":{"executionInfo":{"elapsed":56806,"status":"ok","timestamp":1604477547449,"user":{"displayName":"Ankit Mishra","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14Gj2-BPUB24Nb2m9nv0HdWn-cRfQoBp0ocGjhX-k=s64","userId":"11667803432738710858"},"user_tz":-330},"id":"dyia67ZGcsAw"},"outputs":[],"source":[""]},{"cell_type":"code","execution_count":23,"metadata":{"executionInfo":{"elapsed":56805,"status":"ok","timestamp":1604477547451,"user":{"displayName":"Ankit Mishra","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14Gj2-BPUB24Nb2m9nv0HdWn-cRfQoBp0ocGjhX-k=s64","userId":"11667803432738710858"},"user_tz":-330},"id":"9OFnlq1Hcr8s"},"outputs":[],"source":[""]},{"cell_type":"markdown","metadata":{"id":"HNK1V27M5B1Z"},"source":["# TFIDF vectorizer"]},{"cell_type":"code","execution_count":24,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":57311,"status":"ok","timestamp":1604477547965,"user":{"displayName":"Ankit Mishra","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14Gj2-BPUB24Nb2m9nv0HdWn-cRfQoBp0ocGjhX-k=s64","userId":"11667803432738710858"},"user_tz":-330},"id":"q-UVQjp-sQ-2","outputId":"099e53ac-8646-452c-e715-2dad5a8b442b"},"outputs":[{"data":{"text/plain":["(5728, 2668)"]},"execution_count":24,"metadata":{"tags":[]},"output_type":"execute_result"}],"source":["from sklearn.feature_extraction.text import TfidfVectorizer\n","tfidf1 = TfidfVectorizer(ngram_range=(1,1),min_df =2,max_df =0.5)                #tfidf object   for 1 gramm        \n","features1 = tfidf1.fit_transform(data['Post'])  \n","vector1=features1.toarray()\n","vector1.shape"]},{"cell_type":"code","execution_count":25,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":57306,"status":"ok","timestamp":1604477547967,"user":{"displayName":"Ankit Mishra","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14Gj2-BPUB24Nb2m9nv0HdWn-cRfQoBp0ocGjhX-k=s64","userId":"11667803432738710858"},"user_tz":-330},"id":"EOCNhOUCse1z","outputId":"37f82fb2-ff89-4be5-bcb0-56d57dc55c61"},"outputs":[{"data":{"text/plain":["(5728, 10396)"]},"execution_count":25,"metadata":{"tags":[]},"output_type":"execute_result"}],"source":["tfidf2 = TfidfVectorizer(ngram_range=(2,2),min_df =2,max_df =0.5)                #tfidf object   for 2 gramm        \n","features2 = tfidf2.fit_transform(data['Post'])  \n","vector2=features2.toarray()\n","vector2.shape"]},{"cell_type":"code","execution_count":26,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":57983,"status":"ok","timestamp":1604477548650,"user":{"displayName":"Ankit Mishra","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14Gj2-BPUB24Nb2m9nv0HdWn-cRfQoBp0ocGjhX-k=s64","userId":"11667803432738710858"},"user_tz":-330},"id":"S5b_nPY1se6E","outputId":"2ff76ac0-e82f-4185-c9ae-3e2227123c1b"},"outputs":[{"data":{"text/plain":["(5728, 13064)"]},"execution_count":26,"metadata":{"tags":[]},"output_type":"execute_result"}],"source":["tfidf12 = TfidfVectorizer(ngram_range=(1,2),min_df =2,max_df =0.5)                #tfidf object   for 1,2 gramm        \n","features12 = tfidf12.fit_transform(data['Post'])  \n","vector12=features12.toarray()\n","vector12.shape"]},{"cell_type":"code","execution_count":27,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":58554,"status":"ok","timestamp":1604477549226,"user":{"displayName":"Ankit Mishra","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14Gj2-BPUB24Nb2m9nv0HdWn-cRfQoBp0ocGjhX-k=s64","userId":"11667803432738710858"},"user_tz":-330},"id":"i3jNRvwNse_f","outputId":"17d7a6b9-be15-4646-b0b9-b7c90826ba94"},"outputs":[{"data":{"text/plain":["(5728, 17142)"]},"execution_count":27,"metadata":{"tags":[]},"output_type":"execute_result"}],"source":["tfidf123 = TfidfVectorizer(ngram_range=(1,3),min_df =2,max_df =0.5)                #tfidf object   for 123gramm        \n","features123 = tfidf123.fit_transform(data['Post'])  \n","vector123=features123.toarray()\n","vector123.shape"]},{"cell_type":"markdown","metadata":{"id":"6-TGPLJT2KEV"},"source":["#SPLITING\n"]},{"cell_type":"code","execution_count":28,"metadata":{"executionInfo":{"elapsed":60338,"status":"ok","timestamp":1604477551013,"user":{"displayName":"Ankit Mishra","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14Gj2-BPUB24Nb2m9nv0HdWn-cRfQoBp0ocGjhX-k=s64","userId":"11667803432738710858"},"user_tz":-330},"id":"Ur3IWyq8sfGN"},"outputs":[],"source":["from sklearn.model_selection import train_test_split\n","train_1,val_1,train_2,val_2,train_12,val_12,train_123,val_123,train,test =train_test_split(vector1,vector2,vector12,vector123,data['non-hostile'],test_size=0.10,random_state=24)"]},{"cell_type":"code","execution_count":29,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":60351,"status":"ok","timestamp":1604477551033,"user":{"displayName":"Ankit Mishra","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14Gj2-BPUB24Nb2m9nv0HdWn-cRfQoBp0ocGjhX-k=s64","userId":"11667803432738710858"},"user_tz":-330},"id":"BGpKva82se9y","outputId":"c5d331fa-9fb6-49d1-8bad-983bd07fa777"},"outputs":[{"name":"stdout","output_type":"stream","text":["(5155, 2668)\n","(5155, 10396)\n","(5155, 13064)\n","(5155, 17142)\n","(5155,)\n"]}],"source":["print(train_1.shape)\n","print(train_2.shape)\n","print(train_12.shape)\n","print(train_123.shape)\n","print(train.shape)"]},{"cell_type":"code","execution_count":29,"metadata":{"executionInfo":{"elapsed":60349,"status":"ok","timestamp":1604477551034,"user":{"displayName":"Ankit Mishra","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14Gj2-BPUB24Nb2m9nv0HdWn-cRfQoBp0ocGjhX-k=s64","userId":"11667803432738710858"},"user_tz":-330},"id":"rmzTwFagxMJK"},"outputs":[],"source":[""]},{"cell_type":"markdown","metadata":{"id":"SGC1w-3B01kU"},"source":["#validation data\n"]},{"cell_type":"code","execution_count":30,"metadata":{"colab":{"base_uri":"https://localhost:8080/","height":0},"executionInfo":{"elapsed":60344,"status":"ok","timestamp":1604477551038,"user":{"displayName":"Ankit Mishra","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14Gj2-BPUB24Nb2m9nv0HdWn-cRfQoBp0ocGjhX-k=s64","userId":"11667803432738710858"},"user_tz":-330},"id":"VR2cLyq40y5r","outputId":"55f92b40-5464-4558-9684-9ab9ac0b7865"},"outputs":[{"data":{"text/html":["\u003cdiv\u003e\n","\u003cstyle scoped\u003e\n","    .dataframe tbody tr th:only-of-type {\n","        vertical-align: middle;\n","    }\n","\n","    .dataframe tbody tr th {\n","        vertical-align: top;\n","    }\n","\n","    .dataframe thead th {\n","        text-align: right;\n","    }\n","\u003c/style\u003e\n","\u003ctable border=\"1\" class=\"dataframe\"\u003e\n","  \u003cthead\u003e\n","    \u003ctr style=\"text-align: right;\"\u003e\n","      \u003cth\u003e\u003c/th\u003e\n","      \u003cth\u003eUnique ID\u003c/th\u003e\n","      \u003cth\u003ePost\u003c/th\u003e\n","      \u003cth\u003eLabels Set\u003c/th\u003e\n","    \u003c/tr\u003e\n","  \u003c/thead\u003e\n","  \u003ctbody\u003e\n","    \u003ctr\u003e\n","      \u003cth\u003e0\u003c/th\u003e\n","      \u003ctd\u003e1\u003c/td\u003e\n","      \u003ctd\u003e‡§¶‡•É‡§¢‡§º ‡§á‡§ö‡•ç‡§õ‡§æ ‡§∂‡§ï‡•ç‡§§‡§ø ‡§∏‡•á ‡§™‡§∞‡§ø‡§™‡•Ç‡§∞‡•ç‡§£ ‡§™‡•ç‡§∞‡§£‡§¨‡§¶‡§æ ‡§ï‡•á ‡§≤‡§ø‡§è ‡§¶‡•á‡§∂‡§π‡§ø‡§§ ‡§∏‡§∞‡•ç‡§µ‡•ã‡§ö‡•ç‡§ö ‡§∞‡§π‡§æ‡•§\\n\\n‡§â‡§®‡§ï‡§æ ‡§®‡§ø‡§ß‡§® ‡§π‡§Æ ‡§∏‡§¨ ‡§ï‡•á ‡§≤‡§ø‡§è ‡§Ö‡§™‡•Ç‡§∞‡§£...\u003c/td\u003e\n","      \u003ctd\u003enon-hostile\u003c/td\u003e\n","    \u003c/tr\u003e\n","    \u003ctr\u003e\n","      \u003cth\u003e1\u003c/th\u003e\n","      \u003ctd\u003e2\u003c/td\u003e\n","      \u003ctd\u003e‡§≠‡§æ‡§∞‡§§‡•Ä‡§Ø ‡§ú‡§®‡§§‡§æ ‡§™‡§æ‡§∞‡•ç‡§ü‡•Ä rss ‡§µ‡§æ‡§≤‡•á ‡§á‡§§‡§®‡•á ‡§ó‡§ø‡§∞‡•á ‡§π‡•Å‡§è ‡§π‡•à‡§Ç ‡§ú‡§π‡§æ‡§Ç ‡§Æ‡•à‡§Ç ‡§∞‡§π‡§§‡•Ä ‡§π‡•Ç‡§Ç ‡§µ‡§π‡§æ‡§Ç ‡§Æ‡•á‡§∞‡•Ä ‡§ú‡§æ‡§∏‡•Ç‡§∏‡•Ä  ‡§ï‡§∞‡§æ ‡§∞‡§π‡•á‡§Ç ‡§π‡•à ‡§â‡§∏...\u003c/td\u003e\n","      \u003ctd\u003edefamation\u003c/td\u003e\n","    \u003c/tr\u003e\n","    \u003ctr\u003e\n","      \u003cth\u003e2\u003c/th\u003e\n","      \u003ctd\u003e3\u003c/td\u003e\n","      \u003ctd\u003e‡§ï‡•ã‡§∞‡•ã‡§®‡§æ ‡§∏‡•á ‡§®‡§ø‡§™‡§ü‡§®‡•á ‡§ï‡•Ä ‡§§‡•à‡§Ø‡§æ‡§∞‡•Ä / ‡§¶‡§ø‡§≤‡•ç‡§≤‡•Ä ‡§Æ‡•á‡§Ç 10 ‡§π‡§ú‡§æ‡§∞ ‡§¨‡•á‡§° ‡§µ‡§æ‡§≤‡§æ ‡§¶‡•Å‡§®‡§ø‡§Ø‡§æ ‡§ï‡§æ ‡§∏‡§¨‡§∏‡•á ‡§¨‡§°‡§º‡§æ ‡§ï‡•ã‡§µ‡§ø‡§° ‡§ï‡•á‡§Ø‡§∞ ‡§∏‡•á‡§Ç‡§ü‡§∞ ‡§∂‡•Å...\u003c/td\u003e\n","      \u003ctd\u003enon-hostile\u003c/td\u003e\n","    \u003c/tr\u003e\n","    \u003ctr\u003e\n","      \u003cth\u003e3\u003c/th\u003e\n","      \u003ctd\u003e4\u003c/td\u003e\n","      \u003ctd\u003e‡§ó‡§µ‡§∞‡•ç‡§®‡§∞ ‡§ï‡•â‡§®‡•ç‡§´‡•ç‡§∞‡•á‡§Ç‡§∏ ‡§Æ‡•á‡§Ç PM ‡§Æ‡•ã‡§¶‡•Ä ‡§¨‡•ã‡§≤‡•á- ‡§∂‡§ø‡§ï‡•ç‡§∑‡§æ ‡§®‡•Ä‡§§‡§ø ‡§Æ‡•á‡§Ç ‡§∏‡§∞‡§ï‡§æ‡§∞ ‡§ï‡§æ ‡§¶‡§ñ‡§≤ ‡§ï‡§Æ ‡§π‡•ã‡§®‡§æ ‡§ö‡§æ‡§π‡§ø‡§è\\nhttps://t.co/ZvK...\u003c/td\u003e\n","      \u003ctd\u003enon-hostile\u003c/td\u003e\n","    \u003c/tr\u003e\n","    \u003ctr\u003e\n","      \u003cth\u003e4\u003c/th\u003e\n","      \u003ctd\u003e5\u003c/td\u003e\n","      \u003ctd\u003e‡§Ø‡•Ç‡§™‡•Ä: ‡§ó‡§æ‡§ú‡•Ä‡§™‡•Å‡§∞ ‡§Æ‡•á‡§Ç Toilet ‡§ò‡•ã‡§ü‡§æ‡§≤‡§æ, ‡§™‡•ç‡§∞‡§ß‡§æ‡§® ‡§µ ‡§∏‡§ö‡§ø‡§µ ‡§®‡•á ‡§ï‡§ø‡§Ø‡§æ ‡§≤‡§æ‡§ñ‡•ã‡§Ç ‡§ï‡§æ ‡§ó‡§¨‡§®, ‡§Æ‡•Å‡§∞‡•ç‡§¶‡•ã‡§Ç ‡§ï‡•á ‡§®‡§æ‡§Æ ‡§™‡§∞ ‡§¨‡§®‡§µ‡§æ ‡§°‡§æ‡§≤‡•á...\u003c/td\u003e\n","      \u003ctd\u003enon-hostile\u003c/td\u003e\n","    \u003c/tr\u003e\n","    \u003ctr\u003e\n","      \u003cth\u003e...\u003c/th\u003e\n","      \u003ctd\u003e...\u003c/td\u003e\n","      \u003ctd\u003e...\u003c/td\u003e\n","      \u003ctd\u003e...\u003c/td\u003e\n","    \u003c/tr\u003e\n","    \u003ctr\u003e\n","      \u003cth\u003e806\u003c/th\u003e\n","      \u003ctd\u003e807\u003c/td\u003e\n","      \u003ctd\u003e@ThePushpendra_ ‡§ö‡§Ç‡§¶ ‡§´‡•á‡§Ç‡§ï‡•á ‡§π‡•Å‡§è ‡§ü‡•Å‡§ï‡§°‡§º‡•ã‡§Ç ‡§ï‡•á ‡§≤‡§ø‡§è ‡§π‡§Æ‡•á‡§∂‡§æ ‡§π‡•Ä ‡§¶‡•á‡§∂ ‡§∏‡•á ‡§ó‡§¶‡•ç‡§¶‡§æ‡§∞‡•Ä ‡§ï‡•ã ‡§≠‡•å‡§Ç‡§ï‡§®‡•á ‡§§‡•à‡§Ø‡§æ‡§∞\\n‡§°‡•ç‡§∞‡§ó‡•ç‡§∏ ‡§ï‡•á ...\u003c/td\u003e\n","      \u003ctd\u003ehate\u003c/td\u003e\n","    \u003c/tr\u003e\n","    \u003ctr\u003e\n","      \u003cth\u003e807\u003c/th\u003e\n","      \u003ctd\u003e808\u003c/td\u003e\n","      \u003ctd\u003e‡§Ü‡§Å‡§ñ‡•ã‡§Ç ‡§π‡•Ä ‡§Ü‡§Å‡§ñ‡•ã‡§Ç ‡§Æ‡•á‡§Ç ‡§á‡§∂‡§æ‡§∞‡§æ ‡§π‡•ã ‡§ó‡§Ø‡§æ \\n‡§¨‡•à‡§†‡•á ‡§¨‡•à‡§†‡•á ‡§ú‡•Ä‡§®‡•á ‡§ï‡§æ ‡§∏‡§π‡§æ‡§∞‡§æ ‡§π‡•ã ‡§ó‡§Ø‡§æ üòâüòâüòâ\\n‡§®‡§ú‡§º‡§∞‡•ã‡§Ç ‡§ï‡•Ä ‡§á‡§∏ ‡§Æ‡§æ‡§∞‡§ï ‡§ï‡•ç‡§∑‡§Æ‡§§‡§æ ‡§ï...\u003c/td\u003e\n","      \u003ctd\u003edefamation\u003c/td\u003e\n","    \u003c/tr\u003e\n","    \u003ctr\u003e\n","      \u003cth\u003e808\u003c/th\u003e\n","      \u003ctd\u003e809\u003c/td\u003e\n","      \u003ctd\u003e‡§î‡§∞‡§Ç‡§ó‡§æ‡§¨‡§æ‡§¶ ‡§Æ‡•á‡§Ç ‡§´‡§ø‡§∞ ‡§ß‡•Ä‡§∞‡•á-‡§ß‡•Ä‡§∞‡•á ‡§™‡§æ‡§Ç‡§µ ‡§™‡§∏‡§æ‡§∞ ‡§∞‡§π‡§æ ‡§ï‡•ã‡§∞‡•ã‡§®‡§æ ‡§∏‡§Ç‡§ï‡•ç‡§∞‡§Æ‡§£, ‡§™‡§ø‡§õ‡§≤‡•á 6 ‡§¶‡§ø‡§®‡•ã‡§Ç ‡§Æ‡•á‡§Ç ‡§Æ‡§ø‡§≤‡•á ‡§á‡§§‡§®‡•á ‡§®‡§è ‡§Æ‡§∞‡•Ä‡§ú\\n\\n...\u003c/td\u003e\n","      \u003ctd\u003enon-hostile\u003c/td\u003e\n","    \u003c/tr\u003e\n","    \u003ctr\u003e\n","      \u003cth\u003e809\u003c/th\u003e\n","      \u003ctd\u003e810\u003c/td\u003e\n","      \u003ctd\u003e‡§¨‡§æ‡§á‡§∏‡•ç‡§ï‡•ã‡§™: ‡§ï‡§æ‡§¶‡§∞ ‡§ï‡•á ‡§∏‡§Ç‡§µ‡§æ‡§¶‡•ã‡§Ç ‡§ï‡§æ ‡§ï‡§Æ‡§æ‡§≤, ‡§°‡§ø‡§Ç‡§™‡§≤ ‡§ï‡•Ä ‡§ï‡§≤‡§Æ ‡§ï‡§æ ‡§ß‡§Æ‡§æ‡§≤ ‡§î‡§∞ ‡§§‡•Ä‡§® ‡§¨‡§§‡•ç‡§§‡•Ä ‡§ï‡•á ‡§ú‡§ó‡•ç‡§ó‡•Ç ‡§ï‡§æ ‡§®‡§æ‡§®‡§æ ‡§∏‡§Ç‡§ó ‡§Ö‡§∏‡§≤‡•Ä ‡§¨...\u003c/td\u003e\n","      \u003ctd\u003enon-hostile\u003c/td\u003e\n","    \u003c/tr\u003e\n","    \u003ctr\u003e\n","      \u003cth\u003e810\u003c/th\u003e\n","      \u003ctd\u003e811\u003c/td\u003e\n","      \u003ctd\u003e‡§Ü‡§ñ‡§ø‡§∞‡§ï‡§æ‡§∞ ‡§™‡•â‡§®‡•ç‡§°‡§ø‡§ö‡•á‡§∞‡•Ä ‡§µ‡§ø‡§∂‡•ç‡§µ‡§µ‡§ø‡§¶‡•ç‡§Ø‡§æ‡§≤‡§Ø ‡§ï‡•á ‡§∞‡§æ‡§Æ‡•Ç ‡§®‡§æ‡§Æ ‡§ï‡•á ‡§≠‡§æ‡§∞‡§§‡•Ä‡§Ø ‡§õ‡§æ‡§§‡•ç‡§∞ ‡§®‡•á ‡§ï‡•ã‡§µ‡§ø‡§° -19 ‡§ï‡•á ‡§≤‡§ø‡§è ‡§è‡§ï ‡§ò‡§∞‡•á‡§≤‡•Ç ‡§â‡§™‡§ö‡§æ‡§∞ ...\u003c/td\u003e\n","      \u003ctd\u003efake\u003c/td\u003e\n","    \u003c/tr\u003e\n","  \u003c/tbody\u003e\n","\u003c/table\u003e\n","\u003cp\u003e811 rows √ó 3 columns\u003c/p\u003e\n","\u003c/div\u003e"],"text/plain":["     Unique ID  ...   Labels Set\n","0            1  ...  non-hostile\n","1            2  ...   defamation\n","2            3  ...  non-hostile\n","3            4  ...  non-hostile\n","4            5  ...  non-hostile\n","..         ...  ...          ...\n","806        807  ...         hate\n","807        808  ...   defamation\n","808        809  ...  non-hostile\n","809        810  ...  non-hostile\n","810        811  ...         fake\n","\n","[811 rows x 3 columns]"]},"execution_count":30,"metadata":{"tags":[]},"output_type":"execute_result"}],"source":["vData=pd.read_excel('drive/My Drive/Ankit/october2020 codalab/hindi/Constraint_Hindi_Valid.xlsx')\n","vData"]},{"cell_type":"code","execution_count":31,"metadata":{"executionInfo":{"elapsed":60342,"status":"ok","timestamp":1604477551041,"user":{"displayName":"Ankit Mishra","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14Gj2-BPUB24Nb2m9nv0HdWn-cRfQoBp0ocGjhX-k=s64","userId":"11667803432738710858"},"user_tz":-330},"id":"PMmYvPJr0zBq"},"outputs":[],"source":["vData['Post']=vData['Post'].apply(lambda x:deEmojify(x))\n","vData['Post']=vData['Post'].apply(lambda x:remove_URL(x))\n","vData['Post']=vData['Post'].str.replace(r'\\d+','')\n","#vData['stemm']=vData['Post'].apply(lambda x:stemm(x))"]},{"cell_type":"code","execution_count":32,"metadata":{"executionInfo":{"elapsed":60340,"status":"ok","timestamp":1604477551042,"user":{"displayName":"Ankit Mishra","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14Gj2-BPUB24Nb2m9nv0HdWn-cRfQoBp0ocGjhX-k=s64","userId":"11667803432738710858"},"user_tz":-330},"id":"RTtEm7QhsUl2"},"outputs":[],"source":["vData['label']=vData['Labels Set'].apply(lambda x:Convert(x))"]},{"cell_type":"code","execution_count":33,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":60339,"status":"ok","timestamp":1604477551047,"user":{"displayName":"Ankit Mishra","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14Gj2-BPUB24Nb2m9nv0HdWn-cRfQoBp0ocGjhX-k=s64","userId":"11667803432738710858"},"user_tz":-330},"id":"JrnXyoalsu0x","outputId":"5fe2ac50-2c4a-4198-89ac-284bedfcbd64"},"outputs":[{"data":{"text/plain":["array([[0, 0, 0, 1, 0],\n","       [1, 0, 0, 0, 0],\n","       [0, 0, 0, 1, 0],\n","       ...,\n","       [0, 0, 0, 1, 0],\n","       [0, 0, 0, 1, 0],\n","       [0, 1, 0, 0, 0]])"]},"execution_count":33,"metadata":{"tags":[]},"output_type":"execute_result"}],"source":["vlabel=multilabel.transform(vData['label'])\n","vlabel"]},{"cell_type":"code","execution_count":34,"metadata":{"executionInfo":{"elapsed":60338,"status":"ok","timestamp":1604477551050,"user":{"displayName":"Ankit Mishra","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14Gj2-BPUB24Nb2m9nv0HdWn-cRfQoBp0ocGjhX-k=s64","userId":"11667803432738710858"},"user_tz":-330},"id":"WrcTfIcHsu7E"},"outputs":[],"source":["vData2=pd.DataFrame(vlabel,columns=multilabel.classes_)"]},{"cell_type":"code","execution_count":35,"metadata":{"colab":{"base_uri":"https://localhost:8080/","height":0},"executionInfo":{"elapsed":60331,"status":"ok","timestamp":1604477551052,"user":{"displayName":"Ankit Mishra","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14Gj2-BPUB24Nb2m9nv0HdWn-cRfQoBp0ocGjhX-k=s64","userId":"11667803432738710858"},"user_tz":-330},"id":"JyGDFvr_svEm","outputId":"2025dfcd-433e-4e88-cb3c-07d87c453b71"},"outputs":[{"data":{"text/html":["\u003cdiv\u003e\n","\u003cstyle scoped\u003e\n","    .dataframe tbody tr th:only-of-type {\n","        vertical-align: middle;\n","    }\n","\n","    .dataframe tbody tr th {\n","        vertical-align: top;\n","    }\n","\n","    .dataframe thead th {\n","        text-align: right;\n","    }\n","\u003c/style\u003e\n","\u003ctable border=\"1\" class=\"dataframe\"\u003e\n","  \u003cthead\u003e\n","    \u003ctr style=\"text-align: right;\"\u003e\n","      \u003cth\u003e\u003c/th\u003e\n","      \u003cth\u003ePost\u003c/th\u003e\n","      \u003cth\u003enon-hostile\u003c/th\u003e\n","    \u003c/tr\u003e\n","  \u003c/thead\u003e\n","  \u003ctbody\u003e\n","    \u003ctr\u003e\n","      \u003cth\u003e0\u003c/th\u003e\n","      \u003ctd\u003e‡§¶‡•É‡§¢‡§º ‡§á‡§ö‡•ç‡§õ‡§æ ‡§∂‡§ï‡•ç‡§§‡§ø ‡§∏‡•á ‡§™‡§∞‡§ø‡§™‡•Ç‡§∞‡•ç‡§£ ‡§™‡•ç‡§∞‡§£‡§¨‡§¶‡§æ ‡§ï‡•á ‡§≤‡§ø‡§è ‡§¶‡•á‡§∂‡§π‡§ø‡§§ ‡§∏‡§∞‡•ç‡§µ‡•ã‡§ö‡•ç‡§ö ‡§∞‡§π‡§æ‡•§\\n\\n‡§â‡§®‡§ï‡§æ ‡§®‡§ø‡§ß‡§® ‡§π‡§Æ ‡§∏‡§¨ ‡§ï‡•á ‡§≤‡§ø‡§è ‡§Ö‡§™‡•Ç‡§∞‡§£...\u003c/td\u003e\n","      \u003ctd\u003e1\u003c/td\u003e\n","    \u003c/tr\u003e\n","    \u003ctr\u003e\n","      \u003cth\u003e1\u003c/th\u003e\n","      \u003ctd\u003e‡§≠‡§æ‡§∞‡§§‡•Ä‡§Ø ‡§ú‡§®‡§§‡§æ ‡§™‡§æ‡§∞‡•ç‡§ü‡•Ä rss ‡§µ‡§æ‡§≤‡•á ‡§á‡§§‡§®‡•á ‡§ó‡§ø‡§∞‡•á ‡§π‡•Å‡§è ‡§π‡•à‡§Ç ‡§ú‡§π‡§æ‡§Ç ‡§Æ‡•à‡§Ç ‡§∞‡§π‡§§‡•Ä ‡§π‡•Ç‡§Ç ‡§µ‡§π‡§æ‡§Ç ‡§Æ‡•á‡§∞‡•Ä ‡§ú‡§æ‡§∏‡•Ç‡§∏‡•Ä  ‡§ï‡§∞‡§æ ‡§∞‡§π‡•á‡§Ç ‡§π‡•à ‡§â‡§∏...\u003c/td\u003e\n","      \u003ctd\u003e0\u003c/td\u003e\n","    \u003c/tr\u003e\n","    \u003ctr\u003e\n","      \u003cth\u003e2\u003c/th\u003e\n","      \u003ctd\u003e‡§ï‡•ã‡§∞‡•ã‡§®‡§æ ‡§∏‡•á ‡§®‡§ø‡§™‡§ü‡§®‡•á ‡§ï‡•Ä ‡§§‡•à‡§Ø‡§æ‡§∞‡•Ä / ‡§¶‡§ø‡§≤‡•ç‡§≤‡•Ä ‡§Æ‡•á‡§Ç  ‡§π‡§ú‡§æ‡§∞ ‡§¨‡•á‡§° ‡§µ‡§æ‡§≤‡§æ ‡§¶‡•Å‡§®‡§ø‡§Ø‡§æ ‡§ï‡§æ ‡§∏‡§¨‡§∏‡•á ‡§¨‡§°‡§º‡§æ ‡§ï‡•ã‡§µ‡§ø‡§° ‡§ï‡•á‡§Ø‡§∞ ‡§∏‡•á‡§Ç‡§ü‡§∞ ‡§∂‡•Å‡§∞‡•Ç...\u003c/td\u003e\n","      \u003ctd\u003e1\u003c/td\u003e\n","    \u003c/tr\u003e\n","    \u003ctr\u003e\n","      \u003cth\u003e3\u003c/th\u003e\n","      \u003ctd\u003e‡§ó‡§µ‡§∞‡•ç‡§®‡§∞ ‡§ï‡•â‡§®‡•ç‡§´‡•ç‡§∞‡•á‡§Ç‡§∏ ‡§Æ‡•á‡§Ç PM ‡§Æ‡•ã‡§¶‡•Ä ‡§¨‡•ã‡§≤‡•á- ‡§∂‡§ø‡§ï‡•ç‡§∑‡§æ ‡§®‡•Ä‡§§‡§ø ‡§Æ‡•á‡§Ç ‡§∏‡§∞‡§ï‡§æ‡§∞ ‡§ï‡§æ ‡§¶‡§ñ‡§≤ ‡§ï‡§Æ ‡§π‡•ã‡§®‡§æ ‡§ö‡§æ‡§π‡§ø‡§è\\n\u003c/td\u003e\n","      \u003ctd\u003e1\u003c/td\u003e\n","    \u003c/tr\u003e\n","    \u003ctr\u003e\n","      \u003cth\u003e4\u003c/th\u003e\n","      \u003ctd\u003e‡§Ø‡•Ç‡§™‡•Ä: ‡§ó‡§æ‡§ú‡•Ä‡§™‡•Å‡§∞ ‡§Æ‡•á‡§Ç Toilet ‡§ò‡•ã‡§ü‡§æ‡§≤‡§æ, ‡§™‡•ç‡§∞‡§ß‡§æ‡§® ‡§µ ‡§∏‡§ö‡§ø‡§µ ‡§®‡•á ‡§ï‡§ø‡§Ø‡§æ ‡§≤‡§æ‡§ñ‡•ã‡§Ç ‡§ï‡§æ ‡§ó‡§¨‡§®, ‡§Æ‡•Å‡§∞‡•ç‡§¶‡•ã‡§Ç ‡§ï‡•á ‡§®‡§æ‡§Æ ‡§™‡§∞ ‡§¨‡§®‡§µ‡§æ ‡§°‡§æ‡§≤‡•á...\u003c/td\u003e\n","      \u003ctd\u003e1\u003c/td\u003e\n","    \u003c/tr\u003e\n","    \u003ctr\u003e\n","      \u003cth\u003e...\u003c/th\u003e\n","      \u003ctd\u003e...\u003c/td\u003e\n","      \u003ctd\u003e...\u003c/td\u003e\n","    \u003c/tr\u003e\n","    \u003ctr\u003e\n","      \u003cth\u003e806\u003c/th\u003e\n","      \u003ctd\u003e@ThePushpendra_ ‡§ö‡§Ç‡§¶ ‡§´‡•á‡§Ç‡§ï‡•á ‡§π‡•Å‡§è ‡§ü‡•Å‡§ï‡§°‡§º‡•ã‡§Ç ‡§ï‡•á ‡§≤‡§ø‡§è ‡§π‡§Æ‡•á‡§∂‡§æ ‡§π‡•Ä ‡§¶‡•á‡§∂ ‡§∏‡•á ‡§ó‡§¶‡•ç‡§¶‡§æ‡§∞‡•Ä ‡§ï‡•ã ‡§≠‡•å‡§Ç‡§ï‡§®‡•á ‡§§‡•à‡§Ø‡§æ‡§∞\\n‡§°‡•ç‡§∞‡§ó‡•ç‡§∏ ‡§ï‡•á ...\u003c/td\u003e\n","      \u003ctd\u003e0\u003c/td\u003e\n","    \u003c/tr\u003e\n","    \u003ctr\u003e\n","      \u003cth\u003e807\u003c/th\u003e\n","      \u003ctd\u003e‡§Ü‡§Å‡§ñ‡•ã‡§Ç ‡§π‡•Ä ‡§Ü‡§Å‡§ñ‡•ã‡§Ç ‡§Æ‡•á‡§Ç ‡§á‡§∂‡§æ‡§∞‡§æ ‡§π‡•ã ‡§ó‡§Ø‡§æ \\n‡§¨‡•à‡§†‡•á ‡§¨‡•à‡§†‡•á ‡§ú‡•Ä‡§®‡•á ‡§ï‡§æ ‡§∏‡§π‡§æ‡§∞‡§æ ‡§π‡•ã ‡§ó‡§Ø‡§æ \\n‡§®‡§ú‡§º‡§∞‡•ã‡§Ç ‡§ï‡•Ä ‡§á‡§∏ ‡§Æ‡§æ‡§∞‡§ï ‡§ï‡•ç‡§∑‡§Æ‡§§‡§æ ‡§ï‡•ã ‡§ï...\u003c/td\u003e\n","      \u003ctd\u003e0\u003c/td\u003e\n","    \u003c/tr\u003e\n","    \u003ctr\u003e\n","      \u003cth\u003e808\u003c/th\u003e\n","      \u003ctd\u003e‡§î‡§∞‡§Ç‡§ó‡§æ‡§¨‡§æ‡§¶ ‡§Æ‡•á‡§Ç ‡§´‡§ø‡§∞ ‡§ß‡•Ä‡§∞‡•á-‡§ß‡•Ä‡§∞‡•á ‡§™‡§æ‡§Ç‡§µ ‡§™‡§∏‡§æ‡§∞ ‡§∞‡§π‡§æ ‡§ï‡•ã‡§∞‡•ã‡§®‡§æ ‡§∏‡§Ç‡§ï‡•ç‡§∞‡§Æ‡§£, ‡§™‡§ø‡§õ‡§≤‡•á  ‡§¶‡§ø‡§®‡•ã‡§Ç ‡§Æ‡•á‡§Ç ‡§Æ‡§ø‡§≤‡•á ‡§á‡§§‡§®‡•á ‡§®‡§è ‡§Æ‡§∞‡•Ä‡§ú\\n\\n#...\u003c/td\u003e\n","      \u003ctd\u003e1\u003c/td\u003e\n","    \u003c/tr\u003e\n","    \u003ctr\u003e\n","      \u003cth\u003e809\u003c/th\u003e\n","      \u003ctd\u003e‡§¨‡§æ‡§á‡§∏‡•ç‡§ï‡•ã‡§™: ‡§ï‡§æ‡§¶‡§∞ ‡§ï‡•á ‡§∏‡§Ç‡§µ‡§æ‡§¶‡•ã‡§Ç ‡§ï‡§æ ‡§ï‡§Æ‡§æ‡§≤, ‡§°‡§ø‡§Ç‡§™‡§≤ ‡§ï‡•Ä ‡§ï‡§≤‡§Æ ‡§ï‡§æ ‡§ß‡§Æ‡§æ‡§≤ ‡§î‡§∞ ‡§§‡•Ä‡§® ‡§¨‡§§‡•ç‡§§‡•Ä ‡§ï‡•á ‡§ú‡§ó‡•ç‡§ó‡•Ç ‡§ï‡§æ ‡§®‡§æ‡§®‡§æ ‡§∏‡§Ç‡§ó ‡§Ö‡§∏‡§≤‡•Ä ‡§¨...\u003c/td\u003e\n","      \u003ctd\u003e1\u003c/td\u003e\n","    \u003c/tr\u003e\n","    \u003ctr\u003e\n","      \u003cth\u003e810\u003c/th\u003e\n","      \u003ctd\u003e‡§Ü‡§ñ‡§ø‡§∞‡§ï‡§æ‡§∞ ‡§™‡•â‡§®‡•ç‡§°‡§ø‡§ö‡•á‡§∞‡•Ä ‡§µ‡§ø‡§∂‡•ç‡§µ‡§µ‡§ø‡§¶‡•ç‡§Ø‡§æ‡§≤‡§Ø ‡§ï‡•á ‡§∞‡§æ‡§Æ‡•Ç ‡§®‡§æ‡§Æ ‡§ï‡•á ‡§≠‡§æ‡§∞‡§§‡•Ä‡§Ø ‡§õ‡§æ‡§§‡•ç‡§∞ ‡§®‡•á ‡§ï‡•ã‡§µ‡§ø‡§° - ‡§ï‡•á ‡§≤‡§ø‡§è ‡§è‡§ï ‡§ò‡§∞‡•á‡§≤‡•Ç ‡§â‡§™‡§ö‡§æ‡§∞ ‡§ñ‡•ã...\u003c/td\u003e\n","      \u003ctd\u003e0\u003c/td\u003e\n","    \u003c/tr\u003e\n","  \u003c/tbody\u003e\n","\u003c/table\u003e\n","\u003cp\u003e811 rows √ó 2 columns\u003c/p\u003e\n","\u003c/div\u003e"],"text/plain":["                                                                                                    Post  non-hostile\n","0    ‡§¶‡•É‡§¢‡§º ‡§á‡§ö‡•ç‡§õ‡§æ ‡§∂‡§ï‡•ç‡§§‡§ø ‡§∏‡•á ‡§™‡§∞‡§ø‡§™‡•Ç‡§∞‡•ç‡§£ ‡§™‡•ç‡§∞‡§£‡§¨‡§¶‡§æ ‡§ï‡•á ‡§≤‡§ø‡§è ‡§¶‡•á‡§∂‡§π‡§ø‡§§ ‡§∏‡§∞‡•ç‡§µ‡•ã‡§ö‡•ç‡§ö ‡§∞‡§π‡§æ‡•§\\n\\n‡§â‡§®‡§ï‡§æ ‡§®‡§ø‡§ß‡§® ‡§π‡§Æ ‡§∏‡§¨ ‡§ï‡•á ‡§≤‡§ø‡§è ‡§Ö‡§™‡•Ç‡§∞‡§£...            1\n","1    ‡§≠‡§æ‡§∞‡§§‡•Ä‡§Ø ‡§ú‡§®‡§§‡§æ ‡§™‡§æ‡§∞‡•ç‡§ü‡•Ä rss ‡§µ‡§æ‡§≤‡•á ‡§á‡§§‡§®‡•á ‡§ó‡§ø‡§∞‡•á ‡§π‡•Å‡§è ‡§π‡•à‡§Ç ‡§ú‡§π‡§æ‡§Ç ‡§Æ‡•à‡§Ç ‡§∞‡§π‡§§‡•Ä ‡§π‡•Ç‡§Ç ‡§µ‡§π‡§æ‡§Ç ‡§Æ‡•á‡§∞‡•Ä ‡§ú‡§æ‡§∏‡•Ç‡§∏‡•Ä  ‡§ï‡§∞‡§æ ‡§∞‡§π‡•á‡§Ç ‡§π‡•à ‡§â‡§∏...            0\n","2    ‡§ï‡•ã‡§∞‡•ã‡§®‡§æ ‡§∏‡•á ‡§®‡§ø‡§™‡§ü‡§®‡•á ‡§ï‡•Ä ‡§§‡•à‡§Ø‡§æ‡§∞‡•Ä / ‡§¶‡§ø‡§≤‡•ç‡§≤‡•Ä ‡§Æ‡•á‡§Ç  ‡§π‡§ú‡§æ‡§∞ ‡§¨‡•á‡§° ‡§µ‡§æ‡§≤‡§æ ‡§¶‡•Å‡§®‡§ø‡§Ø‡§æ ‡§ï‡§æ ‡§∏‡§¨‡§∏‡•á ‡§¨‡§°‡§º‡§æ ‡§ï‡•ã‡§µ‡§ø‡§° ‡§ï‡•á‡§Ø‡§∞ ‡§∏‡•á‡§Ç‡§ü‡§∞ ‡§∂‡•Å‡§∞‡•Ç...            1\n","3                       ‡§ó‡§µ‡§∞‡•ç‡§®‡§∞ ‡§ï‡•â‡§®‡•ç‡§´‡•ç‡§∞‡•á‡§Ç‡§∏ ‡§Æ‡•á‡§Ç PM ‡§Æ‡•ã‡§¶‡•Ä ‡§¨‡•ã‡§≤‡•á- ‡§∂‡§ø‡§ï‡•ç‡§∑‡§æ ‡§®‡•Ä‡§§‡§ø ‡§Æ‡•á‡§Ç ‡§∏‡§∞‡§ï‡§æ‡§∞ ‡§ï‡§æ ‡§¶‡§ñ‡§≤ ‡§ï‡§Æ ‡§π‡•ã‡§®‡§æ ‡§ö‡§æ‡§π‡§ø‡§è\\n            1\n","4    ‡§Ø‡•Ç‡§™‡•Ä: ‡§ó‡§æ‡§ú‡•Ä‡§™‡•Å‡§∞ ‡§Æ‡•á‡§Ç Toilet ‡§ò‡•ã‡§ü‡§æ‡§≤‡§æ, ‡§™‡•ç‡§∞‡§ß‡§æ‡§® ‡§µ ‡§∏‡§ö‡§ø‡§µ ‡§®‡•á ‡§ï‡§ø‡§Ø‡§æ ‡§≤‡§æ‡§ñ‡•ã‡§Ç ‡§ï‡§æ ‡§ó‡§¨‡§®, ‡§Æ‡•Å‡§∞‡•ç‡§¶‡•ã‡§Ç ‡§ï‡•á ‡§®‡§æ‡§Æ ‡§™‡§∞ ‡§¨‡§®‡§µ‡§æ ‡§°‡§æ‡§≤‡•á...            1\n","..                                                                                                   ...          ...\n","806  @ThePushpendra_ ‡§ö‡§Ç‡§¶ ‡§´‡•á‡§Ç‡§ï‡•á ‡§π‡•Å‡§è ‡§ü‡•Å‡§ï‡§°‡§º‡•ã‡§Ç ‡§ï‡•á ‡§≤‡§ø‡§è ‡§π‡§Æ‡•á‡§∂‡§æ ‡§π‡•Ä ‡§¶‡•á‡§∂ ‡§∏‡•á ‡§ó‡§¶‡•ç‡§¶‡§æ‡§∞‡•Ä ‡§ï‡•ã ‡§≠‡•å‡§Ç‡§ï‡§®‡•á ‡§§‡•à‡§Ø‡§æ‡§∞\\n‡§°‡•ç‡§∞‡§ó‡•ç‡§∏ ‡§ï‡•á ...            0\n","807  ‡§Ü‡§Å‡§ñ‡•ã‡§Ç ‡§π‡•Ä ‡§Ü‡§Å‡§ñ‡•ã‡§Ç ‡§Æ‡•á‡§Ç ‡§á‡§∂‡§æ‡§∞‡§æ ‡§π‡•ã ‡§ó‡§Ø‡§æ \\n‡§¨‡•à‡§†‡•á ‡§¨‡•à‡§†‡•á ‡§ú‡•Ä‡§®‡•á ‡§ï‡§æ ‡§∏‡§π‡§æ‡§∞‡§æ ‡§π‡•ã ‡§ó‡§Ø‡§æ \\n‡§®‡§ú‡§º‡§∞‡•ã‡§Ç ‡§ï‡•Ä ‡§á‡§∏ ‡§Æ‡§æ‡§∞‡§ï ‡§ï‡•ç‡§∑‡§Æ‡§§‡§æ ‡§ï‡•ã ‡§ï...            0\n","808  ‡§î‡§∞‡§Ç‡§ó‡§æ‡§¨‡§æ‡§¶ ‡§Æ‡•á‡§Ç ‡§´‡§ø‡§∞ ‡§ß‡•Ä‡§∞‡•á-‡§ß‡•Ä‡§∞‡•á ‡§™‡§æ‡§Ç‡§µ ‡§™‡§∏‡§æ‡§∞ ‡§∞‡§π‡§æ ‡§ï‡•ã‡§∞‡•ã‡§®‡§æ ‡§∏‡§Ç‡§ï‡•ç‡§∞‡§Æ‡§£, ‡§™‡§ø‡§õ‡§≤‡•á  ‡§¶‡§ø‡§®‡•ã‡§Ç ‡§Æ‡•á‡§Ç ‡§Æ‡§ø‡§≤‡•á ‡§á‡§§‡§®‡•á ‡§®‡§è ‡§Æ‡§∞‡•Ä‡§ú\\n\\n#...            1\n","809  ‡§¨‡§æ‡§á‡§∏‡•ç‡§ï‡•ã‡§™: ‡§ï‡§æ‡§¶‡§∞ ‡§ï‡•á ‡§∏‡§Ç‡§µ‡§æ‡§¶‡•ã‡§Ç ‡§ï‡§æ ‡§ï‡§Æ‡§æ‡§≤, ‡§°‡§ø‡§Ç‡§™‡§≤ ‡§ï‡•Ä ‡§ï‡§≤‡§Æ ‡§ï‡§æ ‡§ß‡§Æ‡§æ‡§≤ ‡§î‡§∞ ‡§§‡•Ä‡§® ‡§¨‡§§‡•ç‡§§‡•Ä ‡§ï‡•á ‡§ú‡§ó‡•ç‡§ó‡•Ç ‡§ï‡§æ ‡§®‡§æ‡§®‡§æ ‡§∏‡§Ç‡§ó ‡§Ö‡§∏‡§≤‡•Ä ‡§¨...            1\n","810  ‡§Ü‡§ñ‡§ø‡§∞‡§ï‡§æ‡§∞ ‡§™‡•â‡§®‡•ç‡§°‡§ø‡§ö‡•á‡§∞‡•Ä ‡§µ‡§ø‡§∂‡•ç‡§µ‡§µ‡§ø‡§¶‡•ç‡§Ø‡§æ‡§≤‡§Ø ‡§ï‡•á ‡§∞‡§æ‡§Æ‡•Ç ‡§®‡§æ‡§Æ ‡§ï‡•á ‡§≠‡§æ‡§∞‡§§‡•Ä‡§Ø ‡§õ‡§æ‡§§‡•ç‡§∞ ‡§®‡•á ‡§ï‡•ã‡§µ‡§ø‡§° - ‡§ï‡•á ‡§≤‡§ø‡§è ‡§è‡§ï ‡§ò‡§∞‡•á‡§≤‡•Ç ‡§â‡§™‡§ö‡§æ‡§∞ ‡§ñ‡•ã...            0\n","\n","[811 rows x 2 columns]"]},"execution_count":35,"metadata":{"tags":[]},"output_type":"execute_result"}],"source":["vDATA = pd.concat([vData,vData2.reindex(vData.index)],axis=1)\n","vdf=vDATA[['Post','non-hostile']]\n","vdf"]},{"cell_type":"code","execution_count":35,"metadata":{"executionInfo":{"elapsed":60328,"status":"ok","timestamp":1604477551052,"user":{"displayName":"Ankit Mishra","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14Gj2-BPUB24Nb2m9nv0HdWn-cRfQoBp0ocGjhX-k=s64","userId":"11667803432738710858"},"user_tz":-330},"id":"FI3XyMuCsvCU"},"outputs":[],"source":[""]},{"cell_type":"code","execution_count":35,"metadata":{"executionInfo":{"elapsed":60327,"status":"ok","timestamp":1604477551054,"user":{"displayName":"Ankit Mishra","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14Gj2-BPUB24Nb2m9nv0HdWn-cRfQoBp0ocGjhX-k=s64","userId":"11667803432738710858"},"user_tz":-330},"id":"xozFlm_Lsu5l"},"outputs":[],"source":[""]},{"cell_type":"code","execution_count":35,"metadata":{"executionInfo":{"elapsed":60325,"status":"ok","timestamp":1604477551056,"user":{"displayName":"Ankit Mishra","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14Gj2-BPUB24Nb2m9nv0HdWn-cRfQoBp0ocGjhX-k=s64","userId":"11667803432738710858"},"user_tz":-330},"id":"_yOsmA8dsuzC"},"outputs":[],"source":[""]},{"cell_type":"code","execution_count":35,"metadata":{"executionInfo":{"elapsed":60323,"status":"ok","timestamp":1604477551058,"user":{"displayName":"Ankit Mishra","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14Gj2-BPUB24Nb2m9nv0HdWn-cRfQoBp0ocGjhX-k=s64","userId":"11667803432738710858"},"user_tz":-330},"id":"WLMX9xUIsuv8"},"outputs":[],"source":[""]},{"cell_type":"code","execution_count":36,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":60318,"status":"ok","timestamp":1604477551059,"user":{"displayName":"Ankit Mishra","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14Gj2-BPUB24Nb2m9nv0HdWn-cRfQoBp0ocGjhX-k=s64","userId":"11667803432738710858"},"user_tz":-330},"id":"Bcrdu-LY1v-u","outputId":"c3494a22-545e-40c7-c3c1-d5028babe281"},"outputs":[{"data":{"text/plain":["(811, 2668)"]},"execution_count":36,"metadata":{"tags":[]},"output_type":"execute_result"}],"source":["t_features1 = tfidf1.transform(vdf['Post'])  \n","t_vector1=t_features1.toarray()\n","t_vector1.shape"]},{"cell_type":"code","execution_count":37,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":60313,"status":"ok","timestamp":1604477551060,"user":{"displayName":"Ankit Mishra","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14Gj2-BPUB24Nb2m9nv0HdWn-cRfQoBp0ocGjhX-k=s64","userId":"11667803432738710858"},"user_tz":-330},"id":"Z6s-fEgf0zMC","outputId":"14d6efd8-6d25-419c-a36c-3b785852cd6c"},"outputs":[{"data":{"text/plain":["(811, 10396)"]},"execution_count":37,"metadata":{"tags":[]},"output_type":"execute_result"}],"source":["t_features2 = tfidf2.transform(vdf['Post'])  \n","t_vector2=t_features2.toarray()\n","t_vector2.shape"]},{"cell_type":"code","execution_count":38,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":61157,"status":"ok","timestamp":1604477551910,"user":{"displayName":"Ankit Mishra","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14Gj2-BPUB24Nb2m9nv0HdWn-cRfQoBp0ocGjhX-k=s64","userId":"11667803432738710858"},"user_tz":-330},"id":"Lh3O_kJR0zSQ","outputId":"7ee4b329-95c1-429b-bd76-6f9f6b99cd83"},"outputs":[{"data":{"text/plain":["(811, 13064)"]},"execution_count":38,"metadata":{"tags":[]},"output_type":"execute_result"}],"source":["t_features12 = tfidf12.transform(vdf['Post'])  \n","t_vector12=t_features12.toarray()\n","t_vector12.shape"]},{"cell_type":"code","execution_count":39,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":61156,"status":"ok","timestamp":1604477551915,"user":{"displayName":"Ankit Mishra","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14Gj2-BPUB24Nb2m9nv0HdWn-cRfQoBp0ocGjhX-k=s64","userId":"11667803432738710858"},"user_tz":-330},"id":"kji08xu50zPT","outputId":"427e616d-b29b-4290-cb13-7d9b5f4fcd59"},"outputs":[{"data":{"text/plain":["(811, 17142)"]},"execution_count":39,"metadata":{"tags":[]},"output_type":"execute_result"}],"source":["t_features123 = tfidf123.transform(vdf['Post'])  \n","t_vector123=t_features123.toarray()\n","t_vector123.shape"]},{"cell_type":"markdown","metadata":{"id":"ten21fxmx48P"},"source":["#SVM"]},{"cell_type":"code","execution_count":40,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":159702,"status":"ok","timestamp":1604477650467,"user":{"displayName":"Ankit Mishra","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14Gj2-BPUB24Nb2m9nv0HdWn-cRfQoBp0ocGjhX-k=s64","userId":"11667803432738710858"},"user_tz":-330},"id":"eU170qZyx4xT","outputId":"1e0ee81c-19f6-4914-db98-4354bedae5cd"},"outputs":[{"name":"stdout","output_type":"stream","text":["SVM\n","Accuracy score = 0.8372379778051788\n","              precision    recall  f1-score   support\n","\n","           0       0.83      0.82      0.82       376\n","           1       0.85      0.85      0.85       435\n","\n","    accuracy                           0.84       811\n","   macro avg       0.84      0.84      0.84       811\n","weighted avg       0.84      0.84      0.84       811\n","\n"]}],"source":["#for 1 gramm\n","\n","from sklearn.metrics import accuracy_score\n","from sklearn import metrics\n","from sklearn.svm import SVC\n","model_SVM = SVC()\n","model_SVM.fit(vector1,data['non-hostile'])\n","pred_SVM = model_SVM.predict(t_vector1)\n","print(\"SVM\")\n","print(\"Accuracy score =\", accuracy_score(vdf['non-hostile'], pred_SVM))\n","print(metrics.classification_report(vdf['non-hostile'],pred_SVM))"]},{"cell_type":"code","execution_count":41,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":633329,"status":"ok","timestamp":1604478124100,"user":{"displayName":"Ankit Mishra","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14Gj2-BPUB24Nb2m9nv0HdWn-cRfQoBp0ocGjhX-k=s64","userId":"11667803432738710858"},"user_tz":-330},"id":"x7-m9wY8x4tV","outputId":"d4f7cce2-29ba-4aae-9c2e-906e58f958b2"},"outputs":[{"name":"stdout","output_type":"stream","text":["SVM\n","Accuracy score = 0.7718865598027127\n","              precision    recall  f1-score   support\n","\n","           0       0.73      0.80      0.76       376\n","           1       0.81      0.75      0.78       435\n","\n","    accuracy                           0.77       811\n","   macro avg       0.77      0.77      0.77       811\n","weighted avg       0.78      0.77      0.77       811\n","\n"]}],"source":["#for 2 gramm\n","\n","model_SVM2 = SVC()\n","model_SVM2.fit(vector2,data['non-hostile'])\n","pred_SVM = model_SVM2.predict(t_vector2)\n","print(\"SVM\")\n","print(\"Accuracy score =\", accuracy_score(vdf['non-hostile'], pred_SVM))\n","print(metrics.classification_report(vdf['non-hostile'],pred_SVM))"]},{"cell_type":"code","execution_count":42,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":1188719,"status":"ok","timestamp":1604478679495,"user":{"displayName":"Ankit Mishra","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14Gj2-BPUB24Nb2m9nv0HdWn-cRfQoBp0ocGjhX-k=s64","userId":"11667803432738710858"},"user_tz":-330},"id":"kf-kMWKCx4pg","outputId":"f68d068f-bd8b-44a2-c68d-313b90874bbb"},"outputs":[{"name":"stdout","output_type":"stream","text":["SVM\n","Accuracy score = 0.842170160295931\n","              precision    recall  f1-score   support\n","\n","           0       0.82      0.84      0.83       376\n","           1       0.86      0.85      0.85       435\n","\n","    accuracy                           0.84       811\n","   macro avg       0.84      0.84      0.84       811\n","weighted avg       0.84      0.84      0.84       811\n","\n"]}],"source":["#for 12 gramm\n","\n","model_SVM12 = SVC()\n","model_SVM12.fit(vector12,data['non-hostile'])\n","pred_SVM = model_SVM12.predict(t_vector12)\n","print(\"SVM\")\n","print(\"Accuracy score =\", accuracy_score(vdf['non-hostile'], pred_SVM))\n","print(metrics.classification_report(vdf['non-hostile'],pred_SVM))"]},{"cell_type":"code","execution_count":43,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":1946602,"status":"ok","timestamp":1604479437383,"user":{"displayName":"Ankit Mishra","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14Gj2-BPUB24Nb2m9nv0HdWn-cRfQoBp0ocGjhX-k=s64","userId":"11667803432738710858"},"user_tz":-330},"id":"uyUqafE1x4nr","outputId":"1ba33f94-7b17-4e82-f5d7-64487b1c105e"},"outputs":[{"name":"stdout","output_type":"stream","text":["SVM\n","Accuracy score = 0.8335388409371147\n","              precision    recall  f1-score   support\n","\n","           0       0.81      0.83      0.82       376\n","           1       0.85      0.83      0.84       435\n","\n","    accuracy                           0.83       811\n","   macro avg       0.83      0.83      0.83       811\n","weighted avg       0.83      0.83      0.83       811\n","\n"]}],"source":["#for 123 gramm\n","\n","model_SVM123 = SVC()\n","model_SVM123.fit(vector123,data['non-hostile'])\n","pred_SVM = model_SVM123.predict(t_vector123)\n","print(\"SVM\")\n","print(\"Accuracy score =\", accuracy_score(vdf['non-hostile'], pred_SVM))\n","print(metrics.classification_report(vdf['non-hostile'],pred_SVM))"]},{"cell_type":"markdown","metadata":{"id":"QN3sc31G41iM"},"source":["#RANDOM FOREST"]},{"cell_type":"code","execution_count":44,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":1952545,"status":"ok","timestamp":1604479443333,"user":{"displayName":"Ankit Mishra","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14Gj2-BPUB24Nb2m9nv0HdWn-cRfQoBp0ocGjhX-k=s64","userId":"11667803432738710858"},"user_tz":-330},"id":"VpC1jcmQx4kQ","outputId":"164cb468-2948-44dd-e413-8eb243ad9b5f"},"outputs":[{"name":"stdout","output_type":"stream","text":["random\n","Accuracy score = 0.7842170160295932\n","              precision    recall  f1-score   support\n","\n","           0       0.74      0.81      0.78       376\n","           1       0.82      0.76      0.79       435\n","\n","    accuracy                           0.78       811\n","   macro avg       0.78      0.79      0.78       811\n","weighted avg       0.79      0.78      0.78       811\n","\n"]}],"source":["#for 1 gramm|\n","\n","from sklearn.ensemble import RandomForestClassifier\n","rf = RandomForestClassifier(n_estimators=100,max_depth=None,min_samples_split=2, random_state=0)\n","rf.fit(vector1,data['non-hostile'])\n","pred_rf = rf.predict(t_vector1)\n","print(\"random\")\n","print(\"Accuracy score =\", accuracy_score(vdf['non-hostile'], pred_rf))\n","print(metrics.classification_report(vdf['non-hostile'], pred_rf))"]},{"cell_type":"code","execution_count":45,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":2038710,"status":"ok","timestamp":1604479529504,"user":{"displayName":"Ankit Mishra","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14Gj2-BPUB24Nb2m9nv0HdWn-cRfQoBp0ocGjhX-k=s64","userId":"11667803432738710858"},"user_tz":-330},"id":"CYJCdW1m0y-P","outputId":"835d370f-0287-4be2-b440-b6b9b93d3226"},"outputs":[{"name":"stdout","output_type":"stream","text":["random\n","Accuracy score = 0.7053020961775586\n","              precision    recall  f1-score   support\n","\n","           0       0.64      0.82      0.72       376\n","           1       0.79      0.61      0.69       435\n","\n","    accuracy                           0.71       811\n","   macro avg       0.72      0.71      0.70       811\n","weighted avg       0.72      0.71      0.70       811\n","\n"]}],"source":["#for 2 gramm\n","\n","rf.fit(vector2,data['non-hostile'])\n","pred_rf = rf.predict(t_vector2)\n","print(\"random\")\n","print(\"Accuracy score =\", accuracy_score(vdf['non-hostile'], pred_rf))\n","print(metrics.classification_report(vdf['non-hostile'], pred_rf))"]},{"cell_type":"code","execution_count":46,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":2064931,"status":"ok","timestamp":1604479555730,"user":{"displayName":"Ankit Mishra","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14Gj2-BPUB24Nb2m9nv0HdWn-cRfQoBp0ocGjhX-k=s64","userId":"11667803432738710858"},"user_tz":-330},"id":"DUjVHxUp5XJ6","outputId":"d1ea482d-1680-4f32-f2d0-7777ceccc656"},"outputs":[{"name":"stdout","output_type":"stream","text":["random\n","Accuracy score = 0.7768187422934648\n","              precision    recall  f1-score   support\n","\n","           0       0.73      0.82      0.77       376\n","           1       0.83      0.74      0.78       435\n","\n","    accuracy                           0.78       811\n","   macro avg       0.78      0.78      0.78       811\n","weighted avg       0.78      0.78      0.78       811\n","\n"]}],"source":["#for 12 gram\n","\n","rf.fit(vector12,data['non-hostile'])\n","pred_rf = rf.predict(t_vector12)\n","print(\"random\")\n","print(\"Accuracy score =\", accuracy_score(vdf['non-hostile'], pred_rf))\n","print(metrics.classification_report(vdf['non-hostile'], pred_rf))"]},{"cell_type":"code","execution_count":47,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":2099072,"status":"ok","timestamp":1604479589877,"user":{"displayName":"Ankit Mishra","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14Gj2-BPUB24Nb2m9nv0HdWn-cRfQoBp0ocGjhX-k=s64","userId":"11667803432738710858"},"user_tz":-330},"id":"omQTrOuU5cTZ","outputId":"61e2e37d-bef7-4e1b-8cab-350c140da112"},"outputs":[{"name":"stdout","output_type":"stream","text":["random\n","Accuracy score = 0.7903822441430333\n","              precision    recall  f1-score   support\n","\n","           0       0.74      0.84      0.79       376\n","           1       0.85      0.74      0.79       435\n","\n","    accuracy                           0.79       811\n","   macro avg       0.79      0.79      0.79       811\n","weighted avg       0.80      0.79      0.79       811\n","\n"]}],"source":["#for123 gramm\n","\n","rf.fit(vector123,data['non-hostile'])\n","pred_rf = rf.predict(t_vector123)\n","print(\"random\")\n","print(\"Accuracy score =\", accuracy_score(vdf['non-hostile'], pred_rf))\n","print(metrics.classification_report(vdf['non-hostile'], pred_rf))"]},{"cell_type":"markdown","metadata":{"id":"jTVoPMkU7feQ"},"source":["#logestic regression"]},{"cell_type":"code","execution_count":48,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":2099070,"status":"ok","timestamp":1604479589881,"user":{"displayName":"Ankit Mishra","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14Gj2-BPUB24Nb2m9nv0HdWn-cRfQoBp0ocGjhX-k=s64","userId":"11667803432738710858"},"user_tz":-330},"id":"LtBThHF47fRH","outputId":"741c592c-5918-44ad-f5e0-159407b1961a"},"outputs":[{"name":"stdout","output_type":"stream","text":["Logistic Regression\n","Accuracy score = 0.8113440197287299\n","              precision    recall  f1-score   support\n","\n","           0       0.81      0.77      0.79       376\n","           1       0.81      0.84      0.83       435\n","\n","    accuracy                           0.81       811\n","   macro avg       0.81      0.81      0.81       811\n","weighted avg       0.81      0.81      0.81       811\n","\n"]}],"source":["# FOR 1 gram\n","\n","from sklearn.linear_model import LogisticRegression\n","LR = LogisticRegression()\n","LR.fit(vector1,data['non-hostile'])\n","pred_LR = LR.predict(t_vector1)\n","print(\"Logistic Regression\")\n","print(\"Accuracy score =\", accuracy_score(vdf['non-hostile'], pred_LR))\n","print(metrics.classification_report(vdf['non-hostile'], pred_LR ))"]},{"cell_type":"code","execution_count":49,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":2105771,"status":"ok","timestamp":1604479596588,"user":{"displayName":"Ankit Mishra","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14Gj2-BPUB24Nb2m9nv0HdWn-cRfQoBp0ocGjhX-k=s64","userId":"11667803432738710858"},"user_tz":-330},"id":"Dd_39NOP7fM9","outputId":"3998674f-f18c-4189-c434-595d15fb1a28"},"outputs":[{"name":"stdout","output_type":"stream","text":["Logistic Regression\n","Accuracy score = 0.7743526510480888\n","              precision    recall  f1-score   support\n","\n","           0       0.77      0.74      0.75       376\n","           1       0.78      0.80      0.79       435\n","\n","    accuracy                           0.77       811\n","   macro avg       0.77      0.77      0.77       811\n","weighted avg       0.77      0.77      0.77       811\n","\n"]}],"source":["#for2 gramm\n","\n","LR.fit(vector2,data['non-hostile'])\n","pred_LR = LR.predict(t_vector2)\n","print(\"Logistic Regression\")\n","print(\"Accuracy score =\", accuracy_score(vdf['non-hostile'], pred_LR))\n","print(metrics.classification_report(vdf['non-hostile'], pred_LR ))"]},{"cell_type":"code","execution_count":50,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":2109963,"status":"ok","timestamp":1604479600785,"user":{"displayName":"Ankit Mishra","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14Gj2-BPUB24Nb2m9nv0HdWn-cRfQoBp0ocGjhX-k=s64","userId":"11667803432738710858"},"user_tz":-330},"id":"eWvERutO5j3H","outputId":"5c84a84a-2d4e-4556-dabb-ad6e1f71b64d"},"outputs":[{"name":"stdout","output_type":"stream","text":["Logistic Regression\n","Accuracy score = 0.8212083847102343\n","              precision    recall  f1-score   support\n","\n","           0       0.80      0.81      0.81       376\n","           1       0.84      0.83      0.83       435\n","\n","    accuracy                           0.82       811\n","   macro avg       0.82      0.82      0.82       811\n","weighted avg       0.82      0.82      0.82       811\n","\n"]}],"source":["#for12 gramm\n","\n","LR.fit(vector12,data['non-hostile'])\n","pred_LR = LR.predict(t_vector12)\n","print(\"Logistic Regression\")\n","print(\"Accuracy score =\", accuracy_score(vdf['non-hostile'], pred_LR))\n","print(metrics.classification_report(vdf['non-hostile'], pred_LR ))"]},{"cell_type":"code","execution_count":51,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":2115057,"status":"ok","timestamp":1604479605886,"user":{"displayName":"Ankit Mishra","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14Gj2-BPUB24Nb2m9nv0HdWn-cRfQoBp0ocGjhX-k=s64","userId":"11667803432738710858"},"user_tz":-330},"id":"dc3lZNfi8QLk","outputId":"2c8aff94-1663-4cf2-f041-6b5a68e9e67b"},"outputs":[{"name":"stdout","output_type":"stream","text":["Logistic Regression\n","Accuracy score = 0.8199753390875463\n","              precision    recall  f1-score   support\n","\n","           0       0.80      0.81      0.81       376\n","           1       0.84      0.83      0.83       435\n","\n","    accuracy                           0.82       811\n","   macro avg       0.82      0.82      0.82       811\n","weighted avg       0.82      0.82      0.82       811\n","\n"]}],"source":["#for 123 gramm\n","\n","LR.fit(vector123,data['non-hostile'])\n","pred_LR = LR.predict(t_vector123)\n","print(\"Logistic Regression\")\n","print(\"Accuracy score =\", accuracy_score(vdf['non-hostile'], pred_LR))\n","print(metrics.classification_report(vdf['non-hostile'], pred_LR ))"]},{"cell_type":"markdown","metadata":{"id":"WKspE3a5_ohT"},"source":["#KNeighbors"]},{"cell_type":"code","execution_count":52,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":2139565,"status":"ok","timestamp":1604479630401,"user":{"displayName":"Ankit Mishra","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14Gj2-BPUB24Nb2m9nv0HdWn-cRfQoBp0ocGjhX-k=s64","userId":"11667803432738710858"},"user_tz":-330},"id":"nDLaFJGb8VcF","outputId":"f466cea1-be75-4947-8157-49eb3a174209"},"outputs":[{"name":"stdout","output_type":"stream","text":["KNN\n","Accuracy score = 0.7213316892725031\n","              precision    recall  f1-score   support\n","\n","           0       0.63      0.96      0.76       376\n","           1       0.93      0.52      0.67       435\n","\n","    accuracy                           0.72       811\n","   macro avg       0.78      0.74      0.71       811\n","weighted avg       0.79      0.72      0.71       811\n","\n"]}],"source":["#for 1 gram\n","\n","from sklearn.neighbors import KNeighborsClassifier\n","neigh = KNeighborsClassifier(n_neighbors = 5)\n","neigh.fit(vector1,data['non-hostile'])\n","pred_KNN = neigh.predict(t_vector1)\n","print(\"KNN\")\n","print(\"Accuracy score =\", accuracy_score(vdf['non-hostile'], pred_KNN))\n","print(metrics.classification_report(vdf['non-hostile'],pred_KNN ))"]},{"cell_type":"code","execution_count":53,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":2235328,"status":"ok","timestamp":1604479726169,"user":{"displayName":"Ankit Mishra","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14Gj2-BPUB24Nb2m9nv0HdWn-cRfQoBp0ocGjhX-k=s64","userId":"11667803432738710858"},"user_tz":-330},"id":"FQd7xxMbACbQ","outputId":"94671068-db2e-47fa-9b15-c9ad66e00590"},"outputs":[{"name":"stdout","output_type":"stream","text":["KNN\n","Accuracy score = 0.5437731196054254\n","              precision    recall  f1-score   support\n","\n","           0       0.51      0.60      0.55       376\n","           1       0.59      0.49      0.54       435\n","\n","    accuracy                           0.54       811\n","   macro avg       0.55      0.55      0.54       811\n","weighted avg       0.55      0.54      0.54       811\n","\n"]}],"source":["#for 2 gramm\n","\n","neigh.fit(vector2,data['non-hostile'])\n","pred_KNN = neigh.predict(t_vector2)\n","print(\"KNN\")\n","print(\"Accuracy score =\", accuracy_score(vdf['non-hostile'], pred_KNN))\n","print(metrics.classification_report(vdf['non-hostile'],pred_KNN ))"]},{"cell_type":"code","execution_count":54,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":2356585,"status":"ok","timestamp":1604479847433,"user":{"displayName":"Ankit Mishra","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14Gj2-BPUB24Nb2m9nv0HdWn-cRfQoBp0ocGjhX-k=s64","userId":"11667803432738710858"},"user_tz":-330},"id":"2RSxDLU8AMa3","outputId":"d57ba249-589f-40ff-b557-f0fe80951a33"},"outputs":[{"name":"stdout","output_type":"stream","text":["KNN\n","Accuracy score = 0.7237977805178791\n","              precision    recall  f1-score   support\n","\n","           0       0.63      0.97      0.76       376\n","           1       0.95      0.51      0.67       435\n","\n","    accuracy                           0.72       811\n","   macro avg       0.79      0.74      0.72       811\n","weighted avg       0.80      0.72      0.71       811\n","\n"]}],"source":["#for 12 gramm\n","\n","neigh.fit(vector12,data['non-hostile'])\n","pred_KNN = neigh.predict(t_vector12)\n","print(\"KNN\")\n","print(\"Accuracy score =\", accuracy_score(vdf['non-hostile'], pred_KNN))\n","print(metrics.classification_report(vdf['non-hostile'],pred_KNN ))\n"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"id":"jQiKYcSzARd3"},"outputs":[{"name":"stdout","output_type":"stream","text":["KNN\n","Accuracy score = 0.718865598027127\n","              precision    recall  f1-score   support\n","\n","           0       0.63      0.97      0.76       376\n","           1       0.94      0.51      0.66       435\n","\n","    accuracy                           0.72       811\n","   macro avg       0.79      0.74      0.71       811\n","weighted avg       0.80      0.72      0.71       811\n","\n"]}],"source":["#for 123 gramm\n","\n","neigh.fit(vector123,data['non-hostile'])\n","pred_KNN = neigh.predict(t_vector123)\n","print(\"KNN\")\n","print(\"Accuracy score =\", accuracy_score(vdf['non-hostile'], pred_KNN))\n","print(metrics.classification_report(vdf['non-hostile'],pred_KNN ))"]},{"cell_type":"markdown","metadata":{"id":"MCz4PEZ1BCLS"},"source":["#NAIVE BAYES"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"id":"ctziSHNrBB8x"},"outputs":[{"name":"stdout","output_type":"stream","text":["Naive Bayes\n","Accuracy score = 0.749691738594328\n","              precision    recall  f1-score   support\n","\n","           0       0.66      0.94      0.78       376\n","           1       0.92      0.58      0.71       435\n","\n","    accuracy                           0.75       811\n","   macro avg       0.79      0.76      0.75       811\n","weighted avg       0.80      0.75      0.74       811\n","\n"]}],"source":["# for 1 gram\n","from sklearn.naive_bayes import GaussianNB\n","naive = GaussianNB()\n","naive.fit(vector1,data['non-hostile'])\n","pred_naive = naive.predict(t_vector1)\n","print(\"Naive Bayes\")\n","print(\"Accuracy score =\", accuracy_score(vdf['non-hostile'], pred_naive))\n","print(metrics.classification_report(vdf['non-hostile'], pred_naive ))"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"id":"3OP-68IEBB5_"},"outputs":[{"name":"stdout","output_type":"stream","text":["Naive Bayes\n","Accuracy score = 0.7570900123304563\n","              precision    recall  f1-score   support\n","\n","           0       0.76      0.70      0.73       376\n","           1       0.76      0.81      0.78       435\n","\n","    accuracy                           0.76       811\n","   macro avg       0.76      0.75      0.75       811\n","weighted avg       0.76      0.76      0.76       811\n","\n"]}],"source":["#for 2 gram\n","\n","\n","naive.fit(vector2,data['non-hostile'])\n","pred_naive = naive.predict(t_vector2)\n","print(\"Naive Bayes\")\n","print(\"Accuracy score =\", accuracy_score(vdf['non-hostile'], pred_naive))\n","print(metrics.classification_report(vdf['non-hostile'], pred_naive ))\n"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"id":"dYtEf49-BB1Y"},"outputs":[{"name":"stdout","output_type":"stream","text":["Naive Bayes\n","Accuracy score = 0.8187422934648582\n","              precision    recall  f1-score   support\n","\n","           0       0.78      0.85      0.81       376\n","           1       0.86      0.80      0.82       435\n","\n","    accuracy                           0.82       811\n","   macro avg       0.82      0.82      0.82       811\n","weighted avg       0.82      0.82      0.82       811\n","\n"]}],"source":["#for 12 gram\n","\n","\n","naive.fit(vector12,data['non-hostile'])\n","pred_naive = naive.predict(t_vector12)\n","print(\"Naive Bayes\")\n","print(\"Accuracy score =\", accuracy_score(vdf['non-hostile'], pred_naive))\n","print(metrics.classification_report(vdf['non-hostile'], pred_naive ))"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"id":"gc3CP-tEAWH-"},"outputs":[{"name":"stdout","output_type":"stream","text":["Naive Bayes\n","Accuracy score = 0.8199753390875463\n","              precision    recall  f1-score   support\n","\n","           0       0.79      0.83      0.81       376\n","           1       0.85      0.81      0.83       435\n","\n","    accuracy                           0.82       811\n","   macro avg       0.82      0.82      0.82       811\n","weighted avg       0.82      0.82      0.82       811\n","\n"]}],"source":["#for 123 gramm\n","\n","\n","naive.fit(vector123,data['non-hostile'])\n","pred_naive = naive.predict(t_vector123)\n","print(\"Naive Bayes\")\n","print(\"Accuracy score =\", accuracy_score(vdf['non-hostile'], pred_naive))\n","print(metrics.classification_report(vdf['non-hostile'], pred_naive ))"]},{"cell_type":"markdown","metadata":{"id":"_RaXqW_qBmGt"},"source":["# DECISION TREE"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"id":"eDDqaoy4Bh9k"},"outputs":[{"name":"stdout","output_type":"stream","text":["Decision Tree\n","Accuracy score = 0.6757090012330457\n","              precision    recall  f1-score   support\n","\n","           0       0.65      0.66      0.65       376\n","           1       0.70      0.69      0.69       435\n","\n","    accuracy                           0.68       811\n","   macro avg       0.67      0.67      0.67       811\n","weighted avg       0.68      0.68      0.68       811\n","\n"]}],"source":["# for 1 gram\n","from sklearn.tree import DecisionTreeClassifier\n","decision = DecisionTreeClassifier()\n","decision.fit(vector1,data['non-hostile'])\n","pred_decision = decision.predict(t_vector1)\n","print(\"Decision Tree\")\n","print(\"Accuracy score =\", accuracy_score(vdf['non-hostile'],pred_decision))\n","print(metrics.classification_report(vdf['non-hostile'],pred_decision ))"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"id":"Ng5u2jmfB1eU"},"outputs":[{"name":"stdout","output_type":"stream","text":["Decision Tree\n","Accuracy score = 0.6609124537607891\n","              precision    recall  f1-score   support\n","\n","           0       0.60      0.82      0.69       376\n","           1       0.77      0.52      0.62       435\n","\n","    accuracy                           0.66       811\n","   macro avg       0.69      0.67      0.66       811\n","weighted avg       0.69      0.66      0.65       811\n","\n"]}],"source":["#for 2 gramm\n","\n","\n","decision.fit(vector2,data['non-hostile'])\n","pred_decision = decision.predict(t_vector2)\n","print(\"Decision Tree\")\n","print(\"Accuracy score =\", accuracy_score(vdf['non-hostile'],pred_decision))\n","print(metrics.classification_report(vdf['non-hostile'],pred_decision ))"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"id":"5f8wIGs2B9Vi"},"outputs":[{"name":"stdout","output_type":"stream","text":["Decision Tree\n","Accuracy score = 0.6683107274969173\n","              precision    recall  f1-score   support\n","\n","           0       0.63      0.67      0.65       376\n","           1       0.70      0.67      0.68       435\n","\n","    accuracy                           0.67       811\n","   macro avg       0.67      0.67      0.67       811\n","weighted avg       0.67      0.67      0.67       811\n","\n"]}],"source":["#for 12 grammm\n","\n","decision.fit(vector12,data['non-hostile'])\n","pred_decision = decision.predict(t_vector12)\n","print(\"Decision Tree\")\n","print(\"Accuracy score =\", accuracy_score(vdf['non-hostile'],pred_decision))\n","print(metrics.classification_report(vdf['non-hostile'],pred_decision ))"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"id":"BIMccWydCCvE"},"outputs":[{"name":"stdout","output_type":"stream","text":["Decision Tree\n","Accuracy score = 0.6646115906288532\n","              precision    recall  f1-score   support\n","\n","           0       0.63      0.67      0.65       376\n","           1       0.70      0.66      0.68       435\n","\n","    accuracy                           0.66       811\n","   macro avg       0.66      0.66      0.66       811\n","weighted avg       0.67      0.66      0.67       811\n","\n"]}],"source":["# for 123 gramm\n","\n","decision.fit(vector123,data['non-hostile'])\n","pred_decision = decision.predict(t_vector123)\n","print(\"Decision Tree\")\n","print(\"Accuracy score =\", accuracy_score(vdf['non-hostile'],pred_decision))\n","print(metrics.classification_report(vdf['non-hostile'],pred_decision ))"]},{"cell_type":"markdown","metadata":{"id":"jiU0SU2tCKZQ"},"source":["# GradientBoosting"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"id":"y_F-CmKyCGux"},"outputs":[{"name":"stdout","output_type":"stream","text":["Gradient Boosting\n","Accuracy score = 0.688039457459926\n","              precision    recall  f1-score   support\n","\n","           0       0.66      0.69      0.67       376\n","           1       0.72      0.69      0.70       435\n","\n","    accuracy                           0.69       811\n","   macro avg       0.69      0.69      0.69       811\n","weighted avg       0.69      0.69      0.69       811\n","\n"]}],"source":["# for 1 gram\n","from sklearn.ensemble import GradientBoostingClassifier\n","gradient = GradientBoostingClassifier(n_estimators=100,max_depth=None,min_samples_split=2, random_state=0)\n","gradient.fit(vector1,data['non-hostile'])\n","pred_gradient = gradient.predict(t_vector1)\n","print(\"Gradient Boosting\")\n","print(\"Accuracy score =\", accuracy_score(vdf['non-hostile'],pred_gradient))\n","print(metrics.classification_report(vdf['non-hostile'], pred_gradient ))"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"YLpRsHRLCZpM"},"outputs":[],"source":["#for 2 gramm\n","\n","gradient.fit(vector2,data['non-hostile'])\n","pred_gradient = gradient.predict(t_vector2)\n","print(\"Gradient Boosting\")\n","print(\"Accuracy score =\", accuracy_score(vdf['non-hostile'],pred_gradient))\n","print(metrics.classification_report(vdf['non-hostile'], pred_gradient ))"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"rBysjG3VChEO"},"outputs":[],"source":["# for 12 gramm\n","\n","gradient.fit(vector12,data['non-hostile'])\n","pred_gradient = gradient.predict(t_vector12)\n","print(\"Gradient Boosting\")\n","print(\"Accuracy score =\", accuracy_score(vdf['non-hostile'],pred_gradient))\n","print(metrics.classification_report(vdf['non-hostile'], pred_gradient ))"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"XLOlXE5BCqQu"},"outputs":[],"source":["#for 123 gram\n","\n","gradient.fit(vector123,data['non-hostile'])\n","pred_gradient = gradient.predict(t_vector123)\n","print(\"Gradient Boosting\")\n","print(\"Accuracy score =\", accuracy_score(vdf['non-hostile'],pred_gradient))\n","print(metrics.classification_report(vdf['non-hostile'], pred_gradient ))"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"3nLlEV8TCv0v"},"outputs":[],"source":[""]}],"metadata":{"accelerator":"GPU","colab":{"name":"ML task1","version":""},"kernelspec":{"display_name":"Python 3","name":"python3"}},"nbformat":4,"nbformat_minor":0}